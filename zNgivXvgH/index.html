<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>SQL Server - Note</title>
<link rel="shortcut icon" href="https://KA-ASLant.GitHub.io/favicon.ico">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
<link rel="stylesheet" href="https://KA-ASLant.GitHub.io/media/css/tailwind.css">
<link rel="stylesheet" href="https://KA-ASLant.GitHub.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="SQL Server - Note - Atom Feed" href="https://KA-ASLant.GitHub.io/atom.xml">

<script async custom-element="amp-iframe"
  src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  
    

  <meta name="description" content="常用数据类型


char(10)：十个字符串


varchar(10)：弹性容纳十个字符串，小于10则省略多余null字符，上限为10


nchar(10)：可容纳中文的十个Unicode数据


nvarchar(10)：弹性容纳十..." />
  <meta property="og:title" content="SQL Server - Note">
  <meta property="og:description" content="常用数据类型


char(10)：十个字符串


varchar(10)：弹性容纳十个字符串，小于10则省略多余null字符，上限为10


nchar(10)：可容纳中文的十个Unicode数据


nvarchar(10)：弹性容纳十..." />
  <meta property="og:type" content="articles">
  <meta property="og:url" content="https://KA-ASLant.GitHub.io/zNgivXvgH/" />
  <meta property="og:image" content="https://KA-ASLant.GitHub.io/images/avatar.png">
  <meta property="og:image:height" content="630">
  <meta property="og:image:width" content="1200">
  <meta name="twitter:title" content="SQL Server - Note">
  <meta name="twitter:description" content="常用数据类型


char(10)：十个字符串


varchar(10)：弹性容纳十个字符串，小于10则省略多余null字符，上限为10


nchar(10)：可容纳中文的十个Unicode数据


nvarchar(10)：弹性容纳十...">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="canonical" href="https://KA-ASLant.GitHub.io/zNgivXvgH/">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
 
  
    <link rel="stylesheet" href="https://KA-ASLant.GitHub.io/media/css/prism-atom-dark.css">
  

  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
  
</head>

<body>
  <div class="antialiased flex flex-col min-h-screen" id="app">
    <a href="https://KA-ASLant.GitHub.io" class="fixed top-0 left-0 mt-4 bg-black text-white dark:text-gray-700 dark:bg-yellow-50 dark:hover:bg-black dark:hover:text-white inline-flex p-2 pl-8 hover:text-gray-700 hover:bg-yellow-50 font-bold z-10 transition-fast animated fadeInLeft">
      Note
    </a>
    <div class="max-w-4xl w-full mx-auto">
      <div class="shadow-box bg-white dark:bg-gray-600 rounded-lg pt-32 md:pt-64 px-4 md:px-8 pb-8 animated fadeIn mb-8">
        <h1 class="text-5xl font-semibold leading-normal pb-8 mb-8 border-b-8 border-gray-700">
          SQL Server
        </h1>
        
        <div class="mb-8 flex flex-wrap">
          <div class="text-gray-400 text-sm mr-4">2022年05月31日  Tuesday · 18 min read</div>
          
        </div>
        <div class="markdown mb-8" v-pre>
          <h1 id="常用数据类型">常用数据类型</h1>
<ul>
<li>
<p>char(10)：十个字符串</p>
</li>
<li>
<p>varchar(10)：弹性容纳十个字符串，小于10则省略多余null字符，上限为10</p>
</li>
<li>
<p>nchar(10)：可容纳中文的十个Unicode数据</p>
</li>
<li>
<p>nvarchar(10)：弹性容纳十个Unicode数据，小于10则省略多余null字符，上限为10</p>
</li>
<li>
<p>decimal(10.2)：小数类型，长度为10小数点后保留两位</p>
</li>
<li>
<p>time：时间+精确到后七位：HH:MM:SS.1234567</p>
</li>
<li>
<p>date：日期：YYYY-MM-DD</p>
</li>
<li>
<p>datetime：日期+时间+精确到后3位：YYYY-MM-DD HH:MM:SS.123</p>
</li>
<li>
<p>smalldatetime：日期+时间：YYYY-MM-DD HH:MM:SS</p>
</li>
<li>
<p>datetime2：日期+时间+精确到后7位：YYYY-MM-DD HH:MM:SS.1234567</p>
</li>
</ul>
<h1 id="本地连接">本地连接</h1>
<p>如果实例是默认名字即可用英文符号 <code>.</code> 或者 <code>(local)</code> 又或者 <code>localhost</code> 进行连接 如果是自定义名称，那么就需要用 <code>IP\实例名</code> 或 <code>本机名\实例名</code># 约束</p>
<blockquote>
<p><strong>主键约束</strong>：检查当前列是否有重复值，如果有则不保存当前数据进入数据库</p>
</blockquote>
<p>创建方法：表 - 设计 - 右键列名前面 - 设为主键/删除主键 SQL语句添加 - primary key</p>
<pre><code class="language-sql">-- 新建表时添加 primary key
create table Student(
  Sno int identity primary key not null,
)
</code></pre>
<blockquote>
<p><strong>唯一约束unique</strong>：同理主键约束，主键约束也是唯一约束</p>
</blockquote>
<p>创建方法：设计界面右键空白处 - 索引/键 - 添加 - 自定义标识名称(可忽略) - 更改常规的类型为唯一键 SQL语句添加</p>
<pre><code class="language-sql">-- 新建列时添加
create table Student(
  Sno char(8) primary key,
  Sname char(8) unique,
)
-- 已经创建了列的时候添加
alter table Student add unique(Sname)
-- 添加多个对象也是可以的
alter table Student add unique(Sname, Sage)
</code></pre>
<blockquote>
<p><strong>检查约束</strong>：检查当前列中设定的条件是否为真，为假则提示错误</p>
</blockquote>
<p>创建方法：设计界面右键空白处 - Check约束 - 添加 - 自定义标识名称(可忽略) - 常规表达式 - 配置表达式 如：<code>xxx = '男' or xxx = '女'</code> ，xxx为列表名 SQL语句添加</p>
<pre><code class="language-sql">-- 创建列时添加
create table T_Employee(
  Age int not null check(age &gt;= 18 and age &lt;= 50),
);
-- 已有列后添加
alter table T_Employee add check(age &gt;= 18 and age &lt;= 50)
-- 当然也可以同时添加多个check约束
alter table T_Employee add check(age &gt;= 18 and age &lt;= 50), check(EmpName != 'test')
</code></pre>
<blockquote>
<p><strong>默认约束</strong>：默认当前列的数据都是指定数据</p>
</blockquote>
<p>设置方法：列属性 - 默认值绑定 - 设置默认值 SQL语句添加</p>
<pre><code class="language-sql">-- 创建列时添加
create table T_Employee(
  Sex nchar(8) default '保密'
);
-- 已有列后添加
alter table T_Employee add constraint sex default '保密' for sex
</code></pre>
<blockquote>
<p><strong>主键约束与唯一约束的区别</strong>：</p>
</blockquote>
<p>[table id=12 /] 主键约束也是与唯一性相同的，但是他只能有一个且不能为空，而且整个表只存在一个主键，而唯一性约束就是主键“管不到”的列上它来负责数据的唯一性，所以可以拥有多个唯一性约束 # 主键和外键关系</p>
<p>主键就类似于一个核心，外键的数据需要去主键确定是否存在才能存储进入外键数据表 举个例子，假如给学号列表定位主键，因为每个人的学号是独一无二的，我们把整个班级的学号都存储到了主键上，当另一张表想要存储进入一条学号数据时，外键就会先来看看主键是否存在这个学号，如果存在则存储进入自己的表中，否则就提示错误。 建立外键关系也相当与特定情况下为了数据安全增加了一道保障 &gt; 如何建立外键呢？首先得满足以下条件</p>
<ul>
<li>当两个表的某列数据需要关联的时候</li>
<li>一个列创建为外键的时候，另一个列必须为主键</li>
<li>两个列的属性与列名需要完全一致</li>
</ul>
<p>如何区分谁是外键谁是主键？A现在需要去找B确定是否存在这个数据，A就是外键，B就是主键 &gt; 可视化创建方法：</p>
<p>演示一下，这里创建一张名为test1的表，作为外键表，一列为ID列，一列为Name列，他们对应int类型与nvarchar类型 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245482-1.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245482-1.png" alt="" loading="lazy"></a> 然后再新建一个名为test2的表，作为主键表 请注意！因为我要Name这个列创建外键关系，所以在这个主键表需要把Name设为主键 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245493-2.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245493-2.png" alt="" loading="lazy"></a> 两张表的Name列的属性、数据类型、Null是否为空全部一致的情况下，我们回到test1表 右键空白处，点击关系 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245503-3.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245503-3.png" alt="" loading="lazy"></a> 在新的窗口中点击添加，然后在右侧表和列规范点击最右边的按钮 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245511-4.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245511-4.png" alt="" loading="lazy"></a> 然后把主键表改为test2，下面的选项分边选择两张表的Name列 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245519-5.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245519-5.png" alt="" loading="lazy"></a> 然后点击确定，关闭，Ctrl + S保存，此时会提示一个提示更改了表什么什么的，确定即可 这时候我们去编辑test2表，在Name输入两个参数，小明和小红 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245526-6.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245526-6.png" alt="" loading="lazy"></a> 然后我们去编辑test1外键表，尝试在Name里面输入其他的数据 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245534-7.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245534-7.png" alt="" loading="lazy"></a> 此时就会提示约束冲突，然后我们输入主键表中的数据 <a href="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245541-8.png"><img src="https://note.nutssss.cn/wp-content/uploads/2020/03/1583245541-8.png" alt="" loading="lazy"></a> 此时就会发现没问题啦 &gt; 语句创建方法</p>
<p>创建表时添加：constraint 自定义外键名 foreign key (外键列名) references 主键表名(主键列名) 创建表后添加：alter table 外键表名 constraint 自定义外键名 foreign key (外键列名) references 主键表名(主键列名) 当前表的列名为外键，表名(列名)为主键<br>
<code>foreign key (外键名) references 主键表名(主键名)</code></p>
<pre><code class="language-sql">-- 建立表1-Customer里面的CustomerID列与表2-Orders里面的CustomerID列为主外键关系
-- 表2的CustomerID将设置为外键
create table Orders(
  OrderID int primary key,
  CustomerID int,
  foreign key (CustomerID) references Customer(CustomerID)
)

-- 建表后添加
alter table Orders add constraint FK_Orders_Customer foreign key (CustomerID) references Customer(CustomerID)
</code></pre>
<h1 id="增删改查">增删改查</h1>
<blockquote>
<p><strong>create新增数据库</strong></p>
</blockquote>
<pre><code class="language-sql">-- 创建一个名为T_Employee的表
create table T_Employee(
        -- 设置为自增、主键
  EmpId int identity primary key,
  EmpName nvarchar(32) not null,
  Age int not null,
  Sex nchar(8) not null,
  Salary money not null,
  Birthday date not null
);
</code></pre>
<blockquote>
<p><strong>insert新增数据</strong></p>
</blockquote>
<p>insert into 表名 values(对应列内容1 , 对应列内容2 , 对应列内容3... ...)</p>
<pre><code class="language-sql">-- 在test1表中插入一行数据，数据由逗号隔开且顺序对应
insert into test1 values(1, '小明', 18, '男')
</code></pre>
<p>如果需要增加多行就使用union即可 insert into 表名 values(对应列名1 , 对应列名2 , 对应列名3... ...)select 对应列内容1 , 对应列内容2 , 对应列内容3 unionselect 对应列内容1 , 对应列内容2 , 对应列内容3 unionselect 对应列内容1 , 对应列内容2 , 对应列内容3</p>
<pre><code class="language-sql">-- 在test1表中插入多行数据，数据由逗号隔开且顺序对应
insert into test1
select 2, '茄子', 18, '男' union
select 3, '毛子', 20, '男' union
select 4, '小波', 21, '女' union
select 5, '馒老六', 22, '男'
</code></pre>
<p>以上方法适用于正行数据新增，如果只想增加某一项则需要在表名后面列出想要新增的列 insert into 表名(对应列名1 , 对应列名2 , 对应列名3... ...) values(对应列内容1 , 对应列内容2 , 对应列内容3... ...)</p>
<pre><code class="language-sql">-- 在test1表中插入一行数据到指定列，数据由逗号隔开且顺序对应指定列
insert into test1(ID, Age, Gender) values(6, 18, '男')
</code></pre>
<p>如果忽略某内容时，值为NULL &gt; <strong>delete删除数据</strong></p>
<p>delete from 表单名 where 条件</p>
<pre><code class="language-sql">-- 删除test1表中ID=4的一行数据
delete from test1 where ID = 4
</code></pre>
<p>或者删除整个表格的数据，但保留列 delete from 表名</p>
<pre><code class="language-sql">-- 删除了test1表中全部数据，保留了列的属性
delete from test1
</code></pre>
<p>如果不想要这张表单，那么也可以全部移除 drop from 表名 运行完刷新表，就会发现test1表已经不见了，彻底删除</p>
<pre><code class="language-sql">-- 彻底删除整张表test1
drop table test1
</code></pre>
<blockquote>
<p><strong>update修改数据</strong></p>
</blockquote>
<p>update 表名 set 列名= ...</p>
<pre><code class="language-sql">-- 修改test1表的Gender列全部为“女”
update test1 set Gender = '女'
</code></pre>
<p>当然也可以修改数值，增加条件等 update 表名 set 列名 = 'xxx' , 列名 = 'xxx' , 列名 = 'xxx'</p>
<pre><code class="language-sql">-- 修改test1表中Gender列全部改为“骚”；Age列的数值全部+3；ID列数值全部+1
update test1 set Gender = '骚', Age += 3, ID += 1
</code></pre>
<p>当然还可以指定某一行然后修改，比如我们指定ID列列等于5的行，修改他的名字为茄子 update 表名 set 列名 = 'xxx' where 列名 = 'xxx' where后面就是搜索条件</p>
<pre><code class="language-sql">-- 修改test1表中ID=2的一行其中的Name数据为“馒老六”
update test1 set Name = '馒老六' where ID = 2
</code></pre>
<p>where后面条件满足时才会进行索引，否则跳过 &gt; <strong>select：查询数据</strong></p>
<ul>
<li>查询列数据</li>
</ul>
<p>在test1表中查找name列与Age列的全部数据，如果查找单列就输入一个即可 select 列名1,列名2 from 表名</p>
<pre><code class="language-sql">select Name, Age from test1
</code></pre>
<ul>
<li><strong>运算符比较查询</strong></li>
</ul>
<p>在test1表中获取大于18岁的数据（Age &gt; 18） 运算符有&gt;、&lt;、&gt;=、&lt;=、= - <strong>or或关系、and与关系</strong></p>
<p>在这里也可以用到或关系和与关系，或也就是两个条件只需要满足一个即可，而与需要同时满足才行 select * from 表名 where 列名 = xx or 列名 = xx</p>
<pre><code class="language-sql">select * from test1 where Age = 18 or Name = '小黄'
</code></pre>
<p>在这里只要等于18岁的满足条件1，所以搜索出来了；小黄的名字满足条件2，也被搜索出来了</p>
<pre><code class="language-sql">select * from test1 where Age = 18 and Name = '小明'
</code></pre>
<p>这里使用了and，也就是两个必须满足才能搜索到，所以只输出了小明这一行的数据，因为条件1与2全部满足 - <strong>like模糊搜索% , _</strong></p>
<p>like的意思就是模糊查找； %代表的是<strong>任意的字符串</strong>，它的值<strong>可以是空</strong>的也<strong>可以不是空</strong>的 _代表的的是一个<strong>占位符</strong>，可以理解为它是<strong>存在</strong>数据的只是<strong>不知道数据是什么</strong>，它只代表一个数值！并且不能为空！ like演示：找出test1表中Age列全部是18的数据</p>
<pre><code class="language-sql">select * from test1 where Age like '18'
</code></pre>
<p>like就是精确搜索，它同等于where Age = '18' **%演示：**找出test1表中Phone列中前面符合123456数据 因为%他的值可空也可以不空，可以看见小明的Phone数值只有123456但是也被搜索了，因为它后面没有值，满足条件；123456后面还存在数据的也被搜索了，因为后面有数值，也算满足条件，这就是%的使用方法</p>
<pre><code class="language-sql">select * from test1 where Phone like '123456%'
</code></pre>
<p>既然能忽略后面的数值，那么同理也可以忽略前面</p>
<pre><code class="language-sql">select * from test1 where Phone like '%5678'
</code></pre>
<p>前面和后面也可以同时忽略，只提取中间</p>
<pre><code class="language-sql">select * from test1 where Phone like '%56%'
</code></pre>
<p><strong>_演示</strong>：找出test1表中Age列中以8结尾的数据</p>
<pre><code class="language-sql">select * from test1 where Age like '_8'
</code></pre>
<h1 id="修改表名列名与列类型">修改表名列名与列类型</h1>
<pre><code class="language-sql">-- 修改表名 
exec sp_rename '表名', '新表名'
-- 修改列名
exec sp_rename '表名.[列名]', '新列名' , 'column'
--修改表类型
alter table 表名 alter column 列名 数据类型 not null;
</code></pre>
<h1 id="函数">函数</h1>
<blockquote>
<p><strong>修改显示内容：<code>replace</code></strong></p>
</blockquote>
<p>把test1表中的Name列的所有“小明”替换成“小红”并不修改数据内容，只显示在结果 <code>replace(列名, 转换前, 转换后)</code></p>
<pre><code class="language-sql">select replace (Name, '小明', '小红') from test1
</code></pre>
<blockquote>
<p><strong>反向显示：<code>reverse</code></strong></p>
</blockquote>
<p>把test1表中的Name列所有数据全部反向显示，如ABC反向显示为CBA <code>reverse(列名)</code></p>
<pre><code class="language-sql">select reverse(Name) from test1
</code></pre>
<blockquote>
<p><strong>字符串转换为数字：<code>str</code></strong></p>
</blockquote>
<p>将字符串转换成数字并返回 <code>str(数字字符串,  最大长度, 小数后几位)</code>如果数字字符串没有小数，可以忽略第三项的小数后几位设置；最大长度为整个数字的长度，包括小数</p>
<pre><code class="language-sql">select str('123456', 6)
-- 结果为123456
select str('123.456', 6, 3)
-- 结果为123.456
</code></pre>
<blockquote>
<p><strong>提取指定字符：<code>substring</code></strong></p>
</blockquote>
<p>提取“我起了一枪秒了有什么好说的”其中的“一枪秒了”字段 这个并不是从0开始计算，而是从1开始，“我起了”分别是123，“一”处于第四个，所以从4开始截取，然后向后取四个字符 <code>substring('字符串数据', 起始位置, 取值范围)</code></p>
<pre><code class="language-sql">select substring('我起了一枪秒了有什么好说的', 4, 4)
</code></pre>
<blockquote>
<p><strong>返回字符串位置：<code>charindex</code></strong></p>
</blockquote>
<p>返回“我起了一枪秒了有什么好说的”其中的“一枪秒了”在这句话的多少位置 原理同上 <code>charindex('想要查询的字符串', '整个字符串')</code></p>
<pre><code class="language-sql">select charindex('一枪秒了', '我起了一枪秒了有什么好说的')
-- 返回了4
</code></pre>
<blockquote>
<p><strong>获取指定字符串长度：<code>len</code></strong></p>
</blockquote>
<p><code>len('指定字符串')</code></p>
<pre><code class="language-sql">select len('我起了一枪秒了有什么好说的')
</code></pre>
<blockquote>
<p><strong>获取左/右指定数据：<code>left/right</code></strong></p>
</blockquote>
<p>从左/右获取指定的数据 <code>left/right('指定的字符串', 获取多少位)</code></p>
<pre><code class="language-sql">select left('我起了一枪秒了有什么好说的', 5)
select right('我起了一枪秒了有什么好说的', 5)
</code></pre>
<blockquote>
<p><strong>获取当前年月日：<code>getdate</code></strong></p>
</blockquote>
<p>获取当前时间 <code>getdate()</code></p>
<pre><code class="language-sql">select getdate() 当前时间
select day(getdate()) 当前天数
select month(getdate()) 当前月数
select year(getdate()) 当年年数
</code></pre>
<blockquote>
<p><strong>时间戳差距计算：<code>datediff</code></strong></p>
</blockquote>
<p>计算给出的两个时间段相差多少年/月/日 <code>datediff(年/月/日, '时间1', '时间2')</code></p>
<pre><code class="language-sql">-- 依次对应查询年月日
select datediff(year, '2000-1-1', '2002-5-5')
select datediff(month, '2000-1-1', '2002-5-5')
select datediff(day, '2000-1-1', '2002-5-5')
</code></pre>
<p>如果第一个数值比第二个数值要小，将返回负数结果 &gt; <strong>增加时间：<code>dateadd</code></strong></p>
<p>给指定时间增加年/月/日 <code>dateadd(年/月/日, 增加大小, 指定时间)</code></p>
<pre><code class="language-sql">-- 获取当前时间并增加8天
select dateadd(day, 8, getdate())
</code></pre>
<blockquote>
<p><strong>随机取数：<code>rand</code></strong></p>
</blockquote>
<p>在0 - 1中间随机取值 <code>rand()</code></p>
<pre><code class="language-sql">select rand()
</code></pre>
<p>随机取整数可以用*来解决 floor是取0至N-1之间的；ceiling是取0至N之间</p>
<pre><code class="language-sql">select floor(rand()*100)
select ceiling(rand()*100)
</code></pre>
<blockquote>
<p><strong>指定舍去数：<code>round</code></strong></p>
</blockquote>
<p>round的意思就是指定一个位置进行四舍五入，比如我在下方案例里面的数值填上12345.567，把舍去的数值改为2，那么他就会向右边推进两位，然后开始运算四舍五入，也就是保留两位小数变成12345.570 如果我填写-1，那么他就会向左边推进一位，然后开始计算四舍五入，结果为12350.000 同理，如果我填写-2，他就会向左边推进2位进行四舍五入运算，结果为12300.000 <code>round('数值', 舍去的数值)</code></p>
<pre><code class="language-sql">select round(12345.567, -2) --12300.000
select round(12345.567, -1) -- 12350.000
select round(12345.567, 0) -- 12346.000
select round(12345.567, 1) -- 12345.600
select round(12345.567, 2) -- 12345.570
</code></pre>
<blockquote>
<p><strong>转换函数：<code>cast , convert</code></strong></p>
</blockquote>
<p>将数据转换成其他格式 <code>cast(数据 as 类型)``convert(类型, 数据)</code></p>
<pre><code class="language-sql">-- cast转换
select '当前时间为：' + cast(getdate() as nvarchar(max))
-- convert转换
select '当前时间为：' + convert(nvarchar(max), getdate())
</code></pre>
<p>cast与convert的区别就是convert可以格式化时间和数值 # 不允许重复</p>
<p>test1表中存在重复的name值，就可以用distinct去过滤掉重复数据 <code>distinct 列名</code></p>
<pre><code class="language-sql">-- 去掉重复的name
select distinct name from test1
</code></pre>
<h1 id="分组查询group-by">分组查询group by</h1>
<p>group by的主要用处就是对一堆数据进行分组查询，先分组，再查询 <code>group by 分组列名</code></p>
<pre><code class="language-sql">-- 从test表中先把sex分组，然后从分组中查询每个分组最大的salary
select max(salary) from test group by sex
</code></pre>
<h1 id="增加删除字段">增加&amp;&amp;删除字段</h1>
<pre><code class="language-sql">-- 新增字段
alter table 表名 add 字段名 数据类型

-- 删除字段
alter table 表名 drop column 字段名
</code></pre>
<h1 id="替换字段名">替换字段名</h1>
<pre><code class="language-sql">execute sp_rename '表名.字段名','新字段名'
</code></pre>
<h1 id="去重">去重</h1>
<pre><code class="language-sql">select distinct(列名) from 表名
</code></pre>
<h1 id="删除数据库全部表">删除数据库全部表</h1>
<pre><code class="language-sql">use master;
go
sp_msforeachtable @command1=&quot;drop table ?&quot;
go
</code></pre>
<h1 id="主外键设置">主外键设置</h1>
<h2 id="建表时设置">建表时设置</h2>
<p><code>foreign key references [主键表名]([主键列名])</code></p>
<pre><code class="language-sql">create table T_ATM(
    BianHao int primary key identity(1,1),
    MingCheng varchar(20) not null,
    XingBie char(1) not null,
    BiShaJi varchar(300),
    ShenGao decimal(18,2),
    TiZhong decimal(18,2),
    ShengRi date,
    # 设置主键
    ChuShengDiBH int foreign key references T_CSD(ChuShengDiBH),
    TuPian varchar(100)
)
</code></pre>
<h2 id="建表后设置">建表后设置</h2>
<p><code>alter table [外键表名] add constraint 约束名 foreign key ([外键列名]) references [主键表名]([主键列名])</code></p>
<pre><code class="language-sql">alter table [UserInfo] add constraint FK_User_Role_User foreign key ([Id]) references [UserAuth]([Id])
</code></pre>
<h1 id="视图">视图</h1>
<p>视图是一个虚拟的表，是一个表中的数据经过某种筛选后的显示方式，视图由一个预定义的查询select语句组成。</p>
<h2 id="视图的作用">视图的作用</h2>
<ol>
<li>视图隐藏了底层的表结构，简化了数据访问操作，客户端不再需要知道底层表的结构及其之间的关系。</li>
<li>视图提供了一个统一访问数据的接口。（即可以允许用户通过视图访问数据的安全机制，而不授予用户直接访问底层表的权限）</li>
<li>从而加强了安全性，使用户只能看到视图所显示的数据。</li>
<li>视图还可以被嵌套，一个视图中可以嵌套另一个视图。</li>
</ol>
<pre><code class="language-sql">if exists(select * from sys.views where name = 'testView') -- 视图是否存在
drop view testView -- 存在就删除
go
create view testView -- 创建视图
as
select [user_name], [user_passwd], [dept_id] -- 视图内容
from [T_user]
go
select * -- 查询视图
from testView
</code></pre>
<h1 id="存储过程">存储过程</h1>
<blockquote>
<p>创建不带参数存储过程</p>
</blockquote>
<pre><code class="language-sql">if (exists (select * from sys.objects where name = 'proc_get_student'))
    drop proc proc_get_student
go
create proc proc_get_student
as
    select * from student;

--调用、执行存储过程
exec proc_get_student;
</code></pre>
<blockquote>
<p>带参存储过程</p>
</blockquote>
<pre><code class="language-sql">if (object_id('proc_find_stu', 'P') is not null)
    drop proc proc_find_stu
go
create proc proc_find_stu(@startId int, @endId int)
as
    select * from student where id between @startId and @endId
go

exec proc_find_stu 2, 4;
</code></pre>
<h1 id="datediff">datediff</h1>
<p>DATEDIFF() 函数返回两个日期之间的时间。</p>
<pre><code class="language-sql">SELECT DATEDIFF(day,'2008-12-30','2008-12-29') AS DiffDate
-- -1
</code></pre>
<h1 id="isnull">isnull</h1>
<p>isnull(参数1，参数2)，判断参数1是否为NULL，如果是，返回参数2，否则返回参数1。</p>
<pre><code class="language-sql">select ISNULL(null,'helloword') -- 返回helloword字符串
select ISNULL('','helloword') -- 返回 空串
</code></pre>
<h1 id="判断是否为-null">判断是否为 null</h1>
<p>使用 <code>is</code> 或 <code>is not</code> 即可直接判断是否为 null</p>
<pre><code class="language-sql">select * from userinfo where info is not null
</code></pre>

        </div>
        <!-- Share to Twitter, Weibo, Telegram -->
        <div class="flex items-center">
          <div class="mr-4 flex items-center">
            <i class="ri-share-forward-line text-gray-500"></i>
          </div>
          <div class="px-4 cursor-pointer text-blue-500 hover:bg-blue-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTwitter">
            <i class="ri-twitter-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-red-500 hover:bg-red-100 dark:hover:bg-gray-600 inline-flex" @click="shareToWeibo">
            <i class="ri-weibo-line"></i>
          </div>
          <div class="px-4 cursor-pointer text-indigo-500 hover:bg-indigo-100 dark:hover:bg-gray-600 inline-flex" @click="shareToTelegram">
            <i class="ri-telegram-line"></i>
          </div>
        </div>
      </div>

      

      

      <footer class="py-12 text-center px-4 md:px-0" v-pre>
  
</footer>
    </div>

    <!-- TOC Container -->
    <div class="fixed right-0 bottom-0 mb-16 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white dark:bg-gray-500 dark:text-gray-200 hover:shadow-lg transition-all animated fadeInRight" @click="showToc = true">
      <i class="ri-file-list-line"></i>
    </div>

    <div class="fixed right-0 top-0 bottom-0 overflow-y-auto w-64 bg-white dark:bg-gray-800 p-4 border-l border-gray-100 dark:border-gray-600 z-10 transition-fast" :class="{ '-mr-64': !showToc }">
      <div class="flex mb-4 justify-end">
        <div class="w-8 h-8 inline-flex justify-center items-center rounded-full cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-fast" @click="showToc = false">
          <i class="ri-close-line text-lg"></i>
        </div>
      </div>
      <div class="post-toc-container">
        <ul class="markdownIt-TOC">
<li><a href="#%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">常用数据类型</a></li>
<li><a href="#%E6%9C%AC%E5%9C%B0%E8%BF%9E%E6%8E%A5">本地连接</a></li>
<li><a href="#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5">增删改查</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D%E5%88%97%E5%90%8D%E4%B8%8E%E5%88%97%E7%B1%BB%E5%9E%8B">修改表名列名与列类型</a></li>
<li><a href="#%E5%87%BD%E6%95%B0">函数</a></li>
<li><a href="#%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2group-by">分组查询group by</a></li>
<li><a href="#%E5%A2%9E%E5%8A%A0%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5">增加&amp;&amp;删除字段</a></li>
<li><a href="#%E6%9B%BF%E6%8D%A2%E5%AD%97%E6%AE%B5%E5%90%8D">替换字段名</a></li>
<li><a href="#%E5%8E%BB%E9%87%8D">去重</a></li>
<li><a href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%A8%E9%83%A8%E8%A1%A8">删除数据库全部表</a></li>
<li><a href="#%E4%B8%BB%E5%A4%96%E9%94%AE%E8%AE%BE%E7%BD%AE">主外键设置</a>
<ul>
<li><a href="#%E5%BB%BA%E8%A1%A8%E6%97%B6%E8%AE%BE%E7%BD%AE">建表时设置</a></li>
<li><a href="#%E5%BB%BA%E8%A1%A8%E5%90%8E%E8%AE%BE%E7%BD%AE">建表后设置</a></li>
</ul>
</li>
<li><a href="#%E8%A7%86%E5%9B%BE">视图</a>
<ul>
<li><a href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BD%9C%E7%94%A8">视图的作用</a></li>
</ul>
</li>
<li><a href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B">存储过程</a></li>
<li><a href="#datediff">datediff</a></li>
<li><a href="#isnull">isnull</a></li>
<li><a href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA-null">判断是否为 null</a></li>
</ul>

      </div>
    </div>

    <!-- Back to top -->
    <div class="fixed right-0 bottom-0 mb-4 mr-4 shadow w-8 h-8 rounded-full flex justify-center items-center z-10 cursor-pointer bg-white hover:shadow-lg transition-all dark:bg-gray-500 dark:text-gray-200" @click="backToUp" v-show="scrolled">
      <i class="ri-arrow-up-line"></i>
    </div>
  </div>

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe. 
        It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg">
  </div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
      <div class="pswp__item">
      </div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter">
        </div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
        <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip">
        </div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
      </button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
      </button>
      <div class="pswp__caption">
        <div class="pswp__caption__center">
        </div>
      </div>
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://KA-ASLant.GitHub.io/media/scripts/main.js"></script>
  
  <!-- Code Highlight -->
  
    <script src="https://KA-ASLant.GitHub.io/media/prism.js"></script>
    <script>
      Prism.highlightAll()
    </script>
  

  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>
  <script>
    //拿到预览框架，也就是上面的html代码
    var pswpElement = document.querySelectorAll('.pswp')[0];
    //定义图片数组变量
    var imgitems;
    /**
    * 用于显示预览界面
    * @param index 图片数组下标
    */
    function viewImg(index) {
      //其它选项这里不做过多阐述，详情见官网
      var pswpoptions = {
        index: parseInt(index, 10), // 开始幻灯片索引。0是第一张幻灯片。必须是整数，而不是字符串。
        bgOpacity: 0.7, // 背景透明度，0-1
        maxSpreadZoom: 3, // 缩放级别，不要太大
      };
      //初始化并打开PhotoSwipe，pswpElement对应上面预览框架，PhotoSwipeUI_Default为皮肤，imgitems为图片数组，pswpoptions为选项
      var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, imgitems, pswpoptions);
      gallery.init()
    }
    /**
    * 用于添加图片点击事件
    * @param img 图片元素
    * @param index 所属下标（在imgitems中的位置）
    */
    function addImgClick(img, index) {
      img.onclick = function() {
        viewImg(index)
      }
    }
    /**
    * 轮询所有图片，获取src、width、height等数据，加入imgitems，并给图片元素添加事件
    * 最好在onload中执行该方法，本站因放在最底部，所以直接初始化
    * 异步加载图片可在图片元素创建完成后调用此方法
    */
    function initImg() {
      //重置图片数组
      imgitems = [];
      //查找class:markdown 下的所有img元素并遍历
      var imgs = document.querySelectorAll('.markdown img');
      for (var i = 0; i < imgs.length; i++) {
        var img = imgs[i];
        //本站相册初始为loading图片，真实图片放在data-src
        var ds = img.getAttribute("data-src");
        //创建image对象，用于获取图片宽高
        var imgtemp = new Image();
        //判断是否存在data-src
        if (ds != null && ds.length > 0) {
          imgtemp.src = ds
        } else {
          imgtemp.src = img.src
        }
        //判断是否存在缓存
        if (imgtemp.complete) {
          var imgobj = {
            "src": imgtemp.src,
            "w": imgtemp.width,
            "h": imgtemp.height,
          };
          imgitems[i] = imgobj;
          addImgClick(img, i);
        } else {
          console.log('进来了2')
          imgtemp.index = i;
          imgtemp.img = img;
          imgtemp.onload = function() {
            var imgobj = {
              "src": this.src,
              "w": this.width,
              "h": this.height,
            };
            //不要使用push，因为onload前后顺序会不同
            imgitems[this.index] = imgobj
            //添加点击事件
            addImgClick(this.img, this.index);
          }
        }
      }
    }
    //初始化
    initImg();
  </script>
  
  
</body>

</html>