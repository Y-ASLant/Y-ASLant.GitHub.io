import{_ as k,c as p,I as s,j as a,w as r,a as n,au as d,D as i,o as g}from"./chunks/framework.RMxno62p.js";const f=JSON.parse('{"title":"用 Megatron-LM 训练一个 GPT-2","description":"","frontmatter":{"tags":["AI","AI/大语言模型","AI/大语言模型/GPT-2","AI/训练/Megatron-LM","AI/PyTorch","AI/硬件/GPU/NVIDIA/GPU","AI/数据集/OSCAR","AI/算法/CUDA"]},"headers":[],"relativePath":"笔记/🤖 AI 人工智能/用 Megatron-LM 训练一个 GPT-2.md","filePath":"笔记/🤖 AI 人工智能/用 Megatron-LM 训练一个 GPT-2.md"}'),F={name:"笔记/🤖 AI 人工智能/用 Megatron-LM 训练一个 GPT-2.md"},y=a("h1",{id:"用-megatron-lm-训练一个-gpt-2",tabindex:"-1"},[n("用 Megatron-LM 训练一个 GPT-2 "),a("a",{class:"header-anchor",href:"#用-megatron-lm-训练一个-gpt-2","aria-label":'Permalink to "用 Megatron-LM 训练一个 GPT-2"'},"​")],-1),o=d(`<h2 id="环境准备" tabindex="-1">环境准备 <a class="header-anchor" href="#环境准备" aria-label="Permalink to &quot;环境准备&quot;">​</a></h2><p>准备一台有 NVIDIA 显卡和安装了 NVIDIA 驱动和 CUDA 的设备。</p><h3 id="通过-nvidia-的-docker-oci-镜像启动环境" tabindex="-1">通过 NVIDIA 的 Docker / OCI 镜像启动环境 <a class="header-anchor" href="#通过-nvidia-的-docker-oci-镜像启动环境" aria-label="Permalink to &quot;通过 NVIDIA 的 Docker / OCI 镜像启动环境&quot;">​</a></h3><p>引用 NVIDIA 官方的镜像</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nvcr.io/nvidia/pytorch:23.10-py3</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nvcr.io/nvidia/pytorch:23.10-py3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /bin/bash</span></span></code></pre></div><h3 id="额外依赖安装" tabindex="-1">额外依赖安装 <a class="header-anchor" href="#额外依赖安装" aria-label="Permalink to &quot;额外依赖安装&quot;">​</a></h3><p>然后安装一下额外的依赖</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nltk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> numpy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameterized</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pybind11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> regex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> six</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> transformers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;black==21.4b0&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;isort&gt;=5.5.4&#39;</span></span></code></pre></div><h3 id="下载-megatron-lm-源代码" tabindex="-1">下载 Megatron-LM 源代码 <a class="header-anchor" href="#下载-megatron-lm-源代码" aria-label="Permalink to &quot;下载 Megatron-LM 源代码&quot;">​</a></h3><p>下载 Megatron-LM 的源代码，我们需要里面的脚本执行数据处理和训练任务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Git</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://github.com/NVIDIA/megatron-lm.git</span></span></code></pre></div><p>下载完成之后返回之前的目录</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../..</span></span></code></pre></div><h2 id="获取和处理训练数据" tabindex="-1">获取和处理训练数据 <a class="header-anchor" href="#获取和处理训练数据" aria-label="Permalink to &quot;获取和处理训练数据&quot;">​</a></h2><p>创建一个存放这些数据的目录</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Models/gpt-2/data</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Models/gpt-2/data</span></span></code></pre></div><p>在接下来的文档中，将会使用 1GB 79K-record 的 JSON 格式的 OSCAR 数据集。</p><p>可以通过下面的命令下载数据集：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://huggingface.co/bigscience/misc-test-data/resolve/main/stas/oscar-1GB.jsonl.xz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt</span></span></code></pre></div><p>下载之后需要解压 <code>oscar-1GB.jsonl.xz</code> 数据集</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xz</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> oscar-1GB.jsonl.xz</span></span></code></pre></div><p>结束之后返回到 <code>Models/gpt-2</code> 目录</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..</span></span></code></pre></div><p>现在开始预处理数据，调用之前下载好的 megatron-lm 的源代码中包含的 <code>preprocess_data.py</code> 进行数据处理</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../Git/megatron-lm/tools/preprocess_data.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --input</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/oscar-1GB.jsonl</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --output-prefix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> meg-gpt2</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --vocab-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-vocab.json</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --tokenizer-type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT2BPETokenizer</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --merge-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-merges.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --append-eod</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --workers</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8</span></span></code></pre></div><p>如果成功的话，应该会显示这样的信息：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tools/preprocess_data.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --input</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../Models/gpt-2/data/oscar-1GB.jsonl</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --output-prefix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> meg-gpt2</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --vocab-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../Models/gpt-2/data/gpt2-vocab.json</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --tokenizer-type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT2BPETokenizer</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --merge-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../Models/gpt-2/data/gpt2-merges.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --append-eod</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --workers</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Zarr-based</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> strategies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> missing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packages</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Opening</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/oscar-1GB.jsonl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Time</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> startup:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.34363460540771484</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (433.03698501732487 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5.381141666650319</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (515.5098974659498 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6.460766812713121</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (547.6395321994974 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7.101133360189605</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (590.6084364356041 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7.617175617060292</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (573.5710453002679 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7.554493901538309</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (623.1273735138657 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8.179635462737336</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (633.9426166109256 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8.272759185639483</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (660.1344351958044 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8.553866632487171</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (647.7952028223743 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8.3678520892112</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (658.8634135488786 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8.545661855181228</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 中间省略超级多内容</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 70000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (757.3496308210075 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.749606755141295</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 71000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (758.9059010948939 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.771822056903664</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 72000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (757.2054776253033 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.760984420542295</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 73000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (760.2401144979731 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.793640123073587</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 74000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (760.7177564406554 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.80423807920419</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 75000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (761.9462717631283 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.826400662934104</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 76000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (763.4382208273821 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.843172079012716</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 77000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (765.3122602352142 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.86178378657026</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 78000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (767.020968993085 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.884495364192372</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Processed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (765.6928841461199 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">docs/s,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 9.88378937195913</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">).</span></span></code></pre></div><p>处理之后应该是这样的结果</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -la</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 459264</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">drwxr-sr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      4096</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 10:59</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">drwxr-sr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      4096</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 10:48</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">drwxr-sr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      4096</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 09:30</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 468678968</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 10:59</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> meg-gpt2_text_document.bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> users</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1580042</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 10:59</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> meg-gpt2_text_document.idx</span></span></code></pre></div><p>我们将处理好的数据移动到 <code>data</code> 目录下面</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> meg-gpt2</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data</span></span></code></pre></div><h2 id="训练" tabindex="-1">训练 <a class="header-anchor" href="#训练" aria-label="Permalink to &quot;训练&quot;">​</a></h2><h3 id="训练模型" tabindex="-1">训练模型 <a class="header-anchor" href="#训练模型" aria-label="Permalink to &quot;训练模型&quot;">​</a></h3><p>接下来我们创建一个可以反复使用的脚本来训练 GPT-2 模型，可以像下面这样配置来完成单机单卡的训练步骤</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 注意要设置这个环境变量，要不然会报错提示：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># RuntimeError: Using async gradient all reduce requires setting the environment variable CUDA_DEVICE_MAX_CONNECTIONS to 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> CUDA_DEVICE_MAX_CONNECTIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 注意要设置这个环境变量，要不然会报错提示：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Note that --use_env is set by default in torchrun.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># If your script expects \`--local_rank\` argument to be set, please</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># change it to read from \`os.environ[&#39;LOCAL_RANK&#39;]\` instead. See</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># https://pytorch.org/docs/stable/distributed.html#launch-utility for</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># further instructions</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> LOCAL_RANK</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed.launch</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --nproc_per_node</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --nnodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --node_rank</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --master_addr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --master_port</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6000</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    ../../Git/megatron-lm/pretrain_gpt.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --tensor-model-parallel-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --pipeline-model-parallel-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --num-layers</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --hidden-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --num-attention-heads</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --micro-batch-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --global-batch-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --seq-length</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --max-position-embeddings</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --train-iters</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --lr-decay-iters</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 320000</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --save</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --data-path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/meg-gpt2_text_document</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --vocab-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-vocab.json</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --merge-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-merges.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --split</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 949,50,1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --distributed-backend</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nccl</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --lr</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.00015</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --lr-decay-style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cosine</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --min-lr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.0e-5</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --weight-decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-2</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --clip-grad</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --lr-warmup-fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .01</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --recompute-activations</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --log-interval</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --save-interval</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --eval-interval</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --eval-iters</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">    --fp16</span></span></code></pre></div><p>其中：</p><ul><li><code>--nproc_per_node</code> 参数表示每个 worker 有多少个 GPU</li><li><code>--nnodes</code> 参数表示有多少个 worker</li><li><code>--node_rank</code> 参数表示当前的 worker 编号为多少</li></ul><p>如果你修改了 GPU 的数量或者 worker 被增加，需要着重修改这三个参数才能继续训练。</p><p>额外需要注意的是</p><p><code>--hidden-size</code>，<code>--num-attention-heads</code>，<code>--micro-batch-size</code>，<code>--global-batch-size</code> 这几个参数也与 GPU 数量和 worker 数量有关。</p><ul><li>对于 <code>--global-batch-size</code> 参数，必须要保证 <code>worker</code> 的数量 x <code>GPU</code> 的数量是能被 <code>--global-batch-size</code> 整除的。</li><li><code>--hidden-size</code> 要能被 <code>--num-attention-heads</code> 整除</li></ul><p>准备好之后记得分配权限</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./train.sh</span></span></code></pre></div><p>分配完成权限之后调用这个 <code>train.sh</code> 的脚本就可以开始训练了</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./train.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Zarr-based</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> strategies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> missing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packages</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> world</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> context-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tensor-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pipeline-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> args.overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> since</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> non-interleaved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overlapping</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> communication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 中间省略超级多内容</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> learning rate decay style: cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> could</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> find</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> metadata</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2/latest_checkpointed_iteration.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoints</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> random</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/usr/local/lib/python3.8/dist-packages/torch/distributed/distributed_c10d.py:2533:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> UserWarning:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed._all_gather_base</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deprecated.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed.all_gather_into_tensor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> instead.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  warnings.warn(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    load-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (0.19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.19</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after model, optimizer, and learning rate scheduler are built] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> datasets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sizes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (minimum </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    validation:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80080</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">    test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> GPT ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.blended_megatron_dataset_config:Let</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> split_matrix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [(0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.949</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.949,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.999,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _IndexReader</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/meg-gpt2_text_document.idx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lengths</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pointers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequences:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 216895</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 81082</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 368</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> finished creating GPT datasets ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after dataloaders are built] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> with setup ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    model-and-optimizer-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (141.53, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">141.53</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train/valid/test-data-iterators-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (596.36, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">596.36</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">training</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[before the start of training step] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2101.26, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2101.26</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.103246E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.184932E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> saved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    save-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (21027.08, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">21027.08</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (1795.46, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1795.46</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.102900E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.163599E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span></code></pre></div><details class="details custom-block"><summary>完整的训练开始的时候的输出</summary><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./train.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Zarr-based</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> strategies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> missing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packages</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> world</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> context-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tensor-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pipeline-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> args.overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> since</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> non-interleaved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overlapping</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> communication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">------------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> arguments</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> ------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  accumulate_allreduce_grads_in_fp32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_beta1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_beta2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_eps</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-08</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  add_bias_linear</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  add_position_embedding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adlr_autoresume</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adlr_autoresume_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_layernorm_1p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_query_key_layer_scaling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_residual_connection_post_layernorm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_rope_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  async_tensor_model_parallel_allreduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  attention_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  attention_softmax_in_fp32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  barrier_with_L1_time</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_binary_head</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_embedder_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> megatron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bf16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_dropout_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_gelu_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_swiglu_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  biencoder_projection_dim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  biencoder_shared_query_context_model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  block_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  check_for_nan_in_loss_and_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  classes_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clip_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clone_scatter_output_in_embedding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  consumed_train_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  consumed_valid_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  context_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_cache_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_parallel_random_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;./data/meg-gpt2_text_document&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_per_class_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_sharding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dataloader_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> single</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  decoder_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  decoder_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  delay_grad_reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  delay_param_gather</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_bottleneck_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 256</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_freeze_last_layer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_head_hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2048</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_local_crops_number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_local_img_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 96</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_norm_last_layer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_teacher_temp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.07</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_warmup_teacher_temp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.04</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_warmup_teacher_temp_epochs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 30</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distribute_saved_activations</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distributed_backend</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nccl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distributed_timeout_minutes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  embedding_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  empty_unused_memory_level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  encoder_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  encoder_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  end_weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eod_mask_loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eval_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eval_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  evidence_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_duration_in_mins</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_on_missing_checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_signal_handler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expert_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ffn_hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4096</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  finetune</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp16_lm_cross_entropy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp32_residual_connection</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_amax_compute_algo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> most_recent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_amax_history_len</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_margin</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_wgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  global_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  gradient_accumulation_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  group_query_attention</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  head_lr_mult</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hidden_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hysteresis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ict_head_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ict_load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  img_h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 224</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  img_w</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 224</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  indexer_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  indexer_log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  inference_batch_times_seqlen_threshold</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 512</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  init_method_std</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.02</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  init_method_xavier_uniform</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  initial_loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4294967296</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  iter_per_epoch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  kv_channels</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lazy_mpu_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  local_rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_batch_size_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_learning_rate_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_loss_scale_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_memory_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_num_zeros_in_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_params_norm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_throughput</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_timers_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_validation_ppl_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_world_size_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  loss_scale_window</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.00015</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 320000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  make_vocab_size_divisible_by</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc_eval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_factor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.15</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> random</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  masked_softmax_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  max_position_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  max_tokens_to_oom</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  merge_file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-merges.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  micro_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  min_loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  min_lr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  moe_grouped_gemm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  nccl_communicator_config_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_load_optim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_load_rng</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_persist_layer_norm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_save_optim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_save_rng</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  norm_epsilon</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  normalization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LayerNorm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_attention_heads</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_channels</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_classes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_experts</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_layers_per_virtual_pipeline_stage</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_query_groups</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_workers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  onnx_safe</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  openai_gelu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  optimizer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> adam</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  output_bert_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_grad_reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_param_gather</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  override_opt_param_scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  params_dtype</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  patch_dim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  perform_initialization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  pipeline_model_parallel_split_rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  position_embedding_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learned_absolute</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_ranks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [0]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_step_end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_step_start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  query_in_block_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rampup_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_granularity</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> selective</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_method</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  reset_attention_mask</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  reset_position_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_report_topk_accuracies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_score_scaling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 256</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_add_retriever</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_attention_gate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_cyclic_train_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_attention_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_hidden_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_num_neighbors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_num_retrieved_chunks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_return_doc_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_verify_neighbor_count</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_workdir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rotary_percent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rotary_seq_len_interpolation_factor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sample_rate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  save</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  save_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  scatter_gather_tensors_in_pipeline</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  seed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sequence_parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sgd_momentum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  short_seq_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  skip_train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  spec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  split</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 949,50,1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  squared_relu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  standalone_embedding_stage</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  start_weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  swiglu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  swin_backbone_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tiny</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensor_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_queue_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  test_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  timing_log_level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  timing_log_option</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> minmax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  titles_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tokenizer_model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tokenizer_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT2BPETokenizer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_bulk_dgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_bulk_wgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_overlap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_overlap_cfg</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_split_ag</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_split_rs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  transformer_impl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> local</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  transformer_pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  untie_embeddings_and_output_weights</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_checkpoint_args</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_checkpoint_opt_param_scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_cpu_initialization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_distributed_optimizer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_flash_attn</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_mcore_models</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_one_sent_docs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_ring_exchange_p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_rotary_position_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  valid_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  variable_seq_lengths</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  virtual_pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_backbone_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_pretraining</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_pretraining_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> classify</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_extra_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-vocab.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_exp_name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_project</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_save_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  weight_decay_incr_style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  world_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">--------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> arguments</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> ---------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> micro-batches</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building GPT2BPETokenizer tokenizer ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> padded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vocab</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50257</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) with 47 dummy tokens (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50304</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initializing torch distributed ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initialized tensor model parallel with size 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initialized pipeline model parallel with size 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> setting random seeds to 1234 ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> compiling dataset index builder ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Entering</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;/home/neko/Git/megatron-lm/megatron/core/datasets&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Nothing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> done</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;default&#39;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Leaving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;/home/neko/Git/megatron-lm/megatron/core/datasets&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;&gt;&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> builder.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Compilation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.123</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> compiling and loading fused kernels ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;&gt;&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> compiling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loading</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fused</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kernels.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Compilation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.025</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to initialize megatron (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">): 2.810</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after megatron is initialized] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">building</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (tensor, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) model parallel rank (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">): 354871296</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:Number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> buckets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gradient</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> all-reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reduce-scatter:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:Params</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bucket</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (354871296 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">elements</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.final_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.embedding.word_embeddings.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.final_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.embedding.position_embeddings.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> learning rate decay style: cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> could</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> find</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> metadata</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2/latest_checkpointed_iteration.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoints</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> random</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/usr/local/lib/python3.8/dist-packages/torch/distributed/distributed_c10d.py:2533:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> UserWarning:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed._all_gather_base</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deprecated.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed.all_gather_into_tensor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> instead.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  warnings.warn(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    load-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (0.19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.19</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after model, optimizer, and learning rate scheduler are built] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> datasets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sizes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (minimum </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    validation:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80080</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">    test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> GPT ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.blended_megatron_dataset_config:Let</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> split_matrix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [(0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.949</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.949,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.999,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _IndexReader</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/meg-gpt2_text_document.idx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lengths</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pointers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequences:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 216895</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 81082</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 368</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> finished creating GPT datasets ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after dataloaders are built] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> with setup ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    model-and-optimizer-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (141.53, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">141.53</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train/valid/test-data-iterators-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (596.36, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">596.36</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">training</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[before the start of training step] datetime: 2024-01-24 11:10:16</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2101.26, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2101.26</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.103246E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.184932E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> saved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    save-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (21027.08, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">21027.08</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (1795.46, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1795.46</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.102900E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.163599E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span></code></pre></div></details><h3 id="恢复训练" tabindex="-1">恢复训练 <a class="header-anchor" href="#恢复训练" aria-label="Permalink to &quot;恢复训练&quot;">​</a></h3><p>假设出现了错误，比如这样被我主动中断了训练，此时的训练迭代次数（iteration）是 4：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">^CWARNING:torch.distributed.elastic.agent.server.api:Received</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> death</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> signal,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shutting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> down</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> workers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:torch.distributed.elastic.multiprocessing.api:Sending</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> process</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5903</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> closing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> signal</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SIGINT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Traceback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (most </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">recent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> call</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;../../Git/megatron-lm/pretrain_gpt.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 198,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">modul</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    pretrain(train_valid_test_datasets_provider,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/home/neko/Git/megatron-lm/megatron/training.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 182,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pretrain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    iteration</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">forward_step_func,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/home/neko/Git/megatron-lm/megatron/training.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 858,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    save_checkpoint_and_time(iteration,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> optimizer,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/home/neko/Git/megatron-lm/megatron/training.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 717,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> save_checkpoint_and_time</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    save_checkpoint(iteration,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> optimizer,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opt_param_scheduler</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/home/neko/Git/megatron-lm/megatron/checkpointing.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 295,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> save_checkpoint</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    torch.save(state_dict,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint_name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/serialization.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 443,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> save</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    _save(obj,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opened_zipfile,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pickle_module,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pickle_protocol</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/serialization.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 670,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _save</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    zip_file.write_record(name,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> storage.data_ptr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> num_bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">KeyboardInterrupt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Traceback</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (most </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">recent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> call</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/bin/torchrun&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 33,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">modul</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sys.exit(load_entry_point(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&#39;torch==2.0.0a0+1767026&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;console_scripts&#39;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;torchrun&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)())</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 346,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> wrapper</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">args, </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">kwargs)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/run.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 779,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    run(args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/run.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 770,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> run</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    elastic_launch(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/launcher/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 134,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> __call__</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> launch_agent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">self._config,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> self._entrypoint,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/launcher/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 241,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> launch_agent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    result</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> agent.run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/elastic/metrics/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 129,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> wrapper</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    result</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">args, </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">kwargs)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/elastic/agent/server/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 723,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> run</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    result</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> self._invoke_run</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">role</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/elastic/agent/server/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 864,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _invoke_run</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    time.sleep(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">monitor_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  File</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;/usr/local/lib/python3.8/dist-packages/torch/distributed/elastic/multiprocessing/api.py&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 62,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _terminate_process_handler</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    raise</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SignalException</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">f</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;Process {os.getpid()} got signal: {sigval}&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sigval=sigval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">torch.distributed.elastic.multiprocessing.api.SignalException:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Process</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5836</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> got</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> signal:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span></code></pre></div><p>为了能恢复训练，我们需要 checkpoints，而 checkpoints 的保存依赖两个参数：<code>--save</code> 和 <code>--save-interval</code>。</p><ul><li><code>--save</code> 表示 checkpoint 存储在什么路径</li><li><code>--save-interval</code> 表示每过多少次训练迭代次数（iteration）保存一次</li></ul><p>想要恢复训练，也要确保 <code>--load</code> 参数是配置正确的，它将会从 <code>--save</code> 参数配置的路径下的名为 <code>latest_checkpointed_iteration.txt</code> 读取最后一次的训练迭代次数（iteration）的编号，并且读取 <code>--save</code> 参数配置的路径下的形如 <code>iter_0000004</code> 的 checkpoint 文件读取并恢复先前的训练进度。</p><div class="warning custom-block github-alert"><p class="custom-block-title">WARNING</p><p>需要注意的是，如果在训练的过程中修改了并行训练的时候会使用到的 <code>--tensor-model-parallel-size</code> 参数和 <code>--pipeline-model-parallel-size</code> 参数，checkpoint 的结构将会发生变化，这个时候先前的 checkpoint 将不会被 Megatron 所接受，需要整个推翻重新训练才行了。</p></div><p>:::</p><p>想要重新恢复，直接执行之前的脚本就好了：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">./train.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Zarr-based</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> strategies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> missing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packages</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> world</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> context-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tensor-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pipeline-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> args.overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> since</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> non-interleaved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overlapping</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> communication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 中间省略超级多内容</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> learning rate decay style: cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> loading</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.00015</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> minimum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 25600.0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> warmup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2560000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cosine</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> style</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> incr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> style</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loaded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/usr/local/lib/python3.8/dist-packages/torch/distributed/distributed_c10d.py:2533:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> UserWarning:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed._all_gather_base</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deprecated.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed.all_gather_into_tensor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> instead.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  warnings.warn(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    load-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2086.04, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2086.04</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after model, optimizer, and learning rate scheduler are built] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> datasets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sizes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (minimum </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    validation:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80080</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">    test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> GPT ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.blended_megatron_dataset_config:Let</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> split_matrix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [(0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.949</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.949,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.999,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _IndexReader</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/meg-gpt2_text_document.idx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lengths</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pointers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequences:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 216895</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 81082</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 368</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> finished creating GPT datasets ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after dataloaders are built] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> with setup ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    model-and-optimizer-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2266.13, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2266.13</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train/valid/test-data-iterators-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (736.49, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">736.49</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">training</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[before the start of training step] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2113.54, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2113.54</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.102960E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.167297E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span></code></pre></div><details class="details custom-block"><summary>完整的训练开始的时候的输出</summary><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">./train.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Zarr-based</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> strategies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> registered</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> because</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> missing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> packages</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> world</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> context-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tensor-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pipeline-model-parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> args.overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> since</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> non-interleaved</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> schedule</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> overlapping</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> communication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">------------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> arguments</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> ------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  accumulate_allreduce_grads_in_fp32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_beta1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_beta2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adam_eps</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-08</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  add_bias_linear</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  add_position_embedding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adlr_autoresume</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  adlr_autoresume_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_layernorm_1p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_query_key_layer_scaling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_residual_connection_post_layernorm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  apply_rope_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  async_tensor_model_parallel_allreduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  attention_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  attention_softmax_in_fp32</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  barrier_with_L1_time</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_binary_head</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_embedder_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> megatron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bert_load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bf16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_dropout_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_gelu_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  bias_swiglu_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  biencoder_projection_dim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  biencoder_shared_query_context_model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  block_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  check_for_nan_in_loss_and_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  classes_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clip_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  clone_scatter_output_in_embedding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  consumed_train_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  consumed_valid_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  context_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_cache_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_parallel_random_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;./data/meg-gpt2_text_document&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_per_class_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  data_sharding</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dataloader_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> single</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  decoder_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  decoder_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  delay_grad_reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  delay_param_gather</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_bottleneck_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 256</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_freeze_last_layer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_head_hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2048</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_local_crops_number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_local_img_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 96</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_norm_last_layer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_teacher_temp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.07</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_warmup_teacher_temp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.04</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  dino_warmup_teacher_temp_epochs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 30</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distribute_saved_activations</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distributed_backend</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nccl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  distributed_timeout_minutes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  embedding_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  empty_unused_memory_level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  encoder_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  encoder_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  end_weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eod_mask_loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eval_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  eval_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  evidence_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_duration_in_mins</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_on_missing_checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  exit_signal_handler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  expert_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ffn_hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4096</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  finetune</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp16_lm_cross_entropy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp32_residual_connection</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_amax_compute_algo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> most_recent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_amax_history_len</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_margin</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  fp8_wgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  global_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  gradient_accumulation_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  group_query_attention</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  head_lr_mult</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hidden_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hidden_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  hysteresis</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ict_head_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  ict_load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  img_h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 224</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  img_w</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 224</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  indexer_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  indexer_log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  inference_batch_times_seqlen_threshold</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 512</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  init_method_std</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.02</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  init_method_xavier_uniform</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  initial_loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4294967296</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  iter_per_epoch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1250</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  kv_channels</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lazy_mpu_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  local_rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_batch_size_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_learning_rate_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_loss_scale_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_memory_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_num_zeros_in_grad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_params_norm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_throughput</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_timers_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_validation_ppl_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  log_world_size_to_tensorboard</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  loss_scale_window</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.00015</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 320000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_decay_style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_fraction</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_init</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  lr_warmup_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  make_vocab_size_divisible_by</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc_eval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  manual_gc_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_factor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.15</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  mask_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> random</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  masked_softmax_fusion</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  max_position_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  max_tokens_to_oom</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  merge_file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-merges.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  micro_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  min_loss_scale</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  min_lr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  moe_grouped_gemm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  nccl_communicator_config_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_load_optim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_load_rng</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_persist_layer_norm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_save_optim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  no_save_rng</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  norm_epsilon</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  normalization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LayerNorm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_attention_heads</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_channels</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_classes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_experts</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_layers_per_virtual_pipeline_stage</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_query_groups</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  num_workers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  onnx_safe</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  openai_gelu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  optimizer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> adam</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  output_bert_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_grad_reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_p2p_comm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  overlap_param_gather</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  override_opt_param_scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  params_dtype</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.float16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  patch_dim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  perform_initialization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  pipeline_model_parallel_split_rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  position_embedding_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learned_absolute</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_ranks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [0]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_step_end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  profile_step_start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  query_in_block_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rampup_batch_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rank</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_granularity</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> selective</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_method</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  recompute_num_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  reset_attention_mask</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  reset_position_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_report_topk_accuracies</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_score_scaling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retriever_seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 256</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_add_retriever</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_attention_gate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_cyclic_train_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_attention_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_hidden_dropout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_encoder_layers</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_num_neighbors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_num_retrieved_chunks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_return_doc_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_verify_neighbor_count</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  retro_workdir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rotary_percent</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  rotary_seq_len_interpolation_factor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sample_rate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  save</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  save_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  scatter_gather_tensors_in_pipeline</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  seed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1234</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  seq_length</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1024</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sequence_parallel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  sgd_momentum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  short_seq_prob</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  skip_train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  spec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  split</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 949,50,1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  squared_relu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  standalone_embedding_stage</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  start_weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  swiglu</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  swin_backbone_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tiny</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensor_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_log_interval</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tensorboard_queue_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  test_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  timing_log_level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  timing_log_option</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> minmax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  titles_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tokenizer_model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tokenizer_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT2BPETokenizer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_bulk_dgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_bulk_wgrad</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_overlap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_overlap_cfg</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_split_ag</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  tp_comm_split_rs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> True</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_iters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  train_samples</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  transformer_impl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> local</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  transformer_pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ........</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  untie_embeddings_and_output_weights</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_checkpoint_args</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_checkpoint_opt_param_scheduler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_cpu_initialization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_distributed_optimizer</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_flash_attn</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_mcore_models</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_one_sent_docs</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_ring_exchange_p2p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  use_rotary_position_embeddings</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  valid_data_path</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  variable_seq_lengths</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  virtual_pipeline_model_parallel_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_backbone_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_pretraining</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..............................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> False</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vision_pretraining_type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> classify</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_extra_ids</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/gpt2-vocab.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  vocab_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> None</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_exp_name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_project</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  wandb_save_dir</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..................................</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  weight_decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ....................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  weight_decay_incr_style</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .........................</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  world_size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................................</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">--------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> arguments</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> ---------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> micro-batches</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building GPT2BPETokenizer tokenizer ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> padded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vocab</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50257</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) with 47 dummy tokens (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50304</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initializing torch distributed ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initialized tensor model parallel with size 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> initialized pipeline model parallel with size 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> setting random seeds to 1234 ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> compiling dataset index builder ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Entering</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;/home/neko/Git/megatron-lm/megatron/core/datasets&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Nothing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> done</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;default&#39;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">make:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Leaving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;/home/neko/Git/megatron-lm/megatron/core/datasets&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;&gt;&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> builder.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Compilation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.127</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> compiling and loading fused kernels ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;&gt;&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> compiling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loading</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fused</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kernels.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Compilation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.993</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> seconds</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> to initialize megatron (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">): 2.681</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after megatron is initialized] datetime: 2024-01-24 11:13:30</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">building</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> parameters</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (tensor, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) model parallel rank (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">): 354871296</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:Number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> buckets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gradient</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> all-reduce</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reduce-scatter:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:Params</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bucket</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (354871296 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">elements</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.final_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.embedding.position_embeddings.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.final_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.4.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.23.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.input_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.5.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.0.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.self_attention.dense.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.9.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.6.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.embedding.word_embeddings.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.self_attention.query_key_value.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.self_attention.query_key_value.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.13.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.10.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.1.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.20.mlp.dense_4h_to_h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.17.mlp.dense_4h_to_h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.14.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.11.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.8.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.21.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.18.post_attention_norm.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.15.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.12.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.2.mlp.dense_h_to_4h.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.22.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.19.mlp.dense_h_to_4h.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.16.self_attention.dense.bias</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.7.input_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.distributed.grad_buffer:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    module.language_model.encoder.layers.3.post_attention_norm.weight</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> learning rate decay style: cosine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> loading</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.00015</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1e-05</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> minimum</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 25600.0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> warmup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2560000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cosine</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> learning</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> style</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> end</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 8000</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iterations</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> constant</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> weight</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> decay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> incr</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> style</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loaded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/usr/local/lib/python3.8/dist-packages/torch/distributed/distributed_c10d.py:2533:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> UserWarning:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed._all_gather_base</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> private</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> deprecated.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Please</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> torch.distributed.all_gather_into_tensor</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> instead.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  warnings.warn(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    load-checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2086.04, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2086.04</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after model, optimizer, and learning rate scheduler are built] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> datasets</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sizes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (minimum </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      8000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    validation:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80080</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">    test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> building train, validation, and test datasets </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> GPT ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.blended_megatron_dataset_config:Let</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> split_matrix</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [(0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.949</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.949,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.999</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">), (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">0.999,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> _IndexReader</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./data/meg-gpt2_text_document.idx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lengths</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequence</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pointers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    Extract</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sequences:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.indexed_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> documents:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 79000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> train</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 743f9c78682483773343914511a6c2a5-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 216895</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5c58c96640514eacb357eae3e1bd7c1d-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 81082</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GPTDataset</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> indices</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> document</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-document_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-sample_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Load</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> shuffle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 4422b241e58c2eba0e87abb1077559e9-GPTDataset-shuffle_index.npy</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> samples:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 368</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">INFO:megatron.core.datasets.gpt_dataset:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">total</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> epochs:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> finished creating GPT datasets ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[after dataloaders are built] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">done</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> with setup ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    model-and-optimizer-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ......................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2266.13, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2266.13</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    train/valid/test-data-iterators-setup</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..........:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (736.49, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">736.49</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">training</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">[before the start of training step] datetime: 2024-01-24 11:13:33</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">min,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">time</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> across</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ranks</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (ms):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    evaluate</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .......................................:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2113.54, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2113.54</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> validation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> value:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.102960E+01</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> lm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loss</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PPL:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6.167297E+04</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">---------------------------------------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">saving</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> checkpoint</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> iteration</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       4</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ./checkpoints/gpt-2</span></span></code></pre></div></details><h2 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h2>`,61);function C(c,_,u,m,A,b){const e=i("NolebasePageProperties"),l=i("VPNolebaseInlineLinkPreview"),h=i("NolebaseGitContributors"),t=i("NolebaseGitChangelog");return g(),p("div",null,[y,s(e),o,a("p",null,[s(l,{href:"https://help.aliyun.com/zh/ecs/use-cases/use-the-megatron-deepspeed-training-gpt-2-and-generate-text",target:"_blank",rel:"noreferrer"},{default:r(()=>[n("如何训练 GPT-2 模型并生成文本 云服务器 ECS（ECS） - 阿里云帮助中心")]),_:1})]),s(h),s(t)])}const B=k(F,[["render",C]]);export{f as __pageData,B as default};
