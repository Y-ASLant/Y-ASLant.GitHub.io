import{_ as p,c,I as s,j as e,w as i,a as t,au as d,D as o,o as h}from"./chunks/framework.RMxno62p.js";const w=JSON.parse('{"title":"KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜","description":"","frontmatter":{"tags":["å¼€å‘/äº‘åŸç”Ÿ/Kubernetes","å¼€å‘/äº‘åŸç”Ÿ/Kubernetes/K8s","è¿ç»´/äº‘åŸç”Ÿ/Kubernetes","è¿ç»´/äº‘åŸç”Ÿ/Kubernetes/K8s","å‘½ä»¤è¡Œ/kubectl","è¿ç»´/äº‘åŸç”Ÿ/Kubernetes/KubeSphere","å¼€æº/è½¯ä»¶/KubeSphere","å¼€å‘/äº‘åŸç”Ÿ/ç½‘ç»œ/æœåŠ¡ç½‘æ ¼/Service-Mesh","å¼€å‘/äº‘åŸç”Ÿ/ç½‘ç»œ/æœåŠ¡ç½‘æ ¼"]},"headers":[],"relativePath":"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜.md","filePath":"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜.md"}'),u={name:"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜.md"},k=e("h1",{id:"kubesphere-å®‰è£…äº†å¯æ’æ‹”-service-mesh-ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜",tabindex:"-1"},[t("KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜ "),e("a",{class:"header-anchor",href:"#kubesphere-å®‰è£…äº†å¯æ’æ‹”-service-mesh-ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜","aria-label":'Permalink to "KubeSphere å®‰è£…äº†å¯æ’æ‹” Service Mesh ç»„ä»¶ååˆå¸è½½å¯¼è‡´çš„é—®é¢˜"'},"â€‹")],-1),b=e("h3",{id:"æ–‡æ¡£å…¼å®¹æ€§",tabindex:"-1"},[t("æ–‡æ¡£å…¼å®¹æ€§ "),e("a",{class:"header-anchor",href:"#æ–‡æ¡£å…¼å®¹æ€§","aria-label":'Permalink to "æ–‡æ¡£å…¼å®¹æ€§"'},"â€‹")],-1),g={tabindex:"0"},q=e("thead",null,[e("tr",null,[e("th",null,"ä¸»ä½“"),e("th",null,"ç‰ˆæœ¬å·"),e("th",null,"æ–‡æ¡£åœ°å€ï¼ˆå¦‚æœæœ‰ï¼‰")])],-1),v=e("td",null,"KubeSphere",-1),_=e("td",null,"v3.3.0",-1),m=e("td",null,"Kubernetes",-1),y=e("td",null,"v1.22.0",-1),C=d(`<h2 id="è¯´æ˜" tabindex="-1">è¯´æ˜ <a class="header-anchor" href="#è¯´æ˜" aria-label="Permalink to &quot;è¯´æ˜&quot;">â€‹</a></h2><p>æˆ‘åœ¨å°è¯•æ‰‹åŠ¨é€šè¿‡ <code>kubectl</code> å‘½ä»¤ä¸º k8s é›†ç¾¤ä¸Šçš„ deployment æ›´æ–°å…¶éƒ¨ç½²çš„é•œåƒï¼Œä»¥æ–¹ä¾¿é›†æˆåˆ° Circle CI å¹¶æ‰“é€šæ•´ä¸ª CI/CD æµç¨‹æ¥æ›¿æ¢æˆ‘ä»¬å…ˆå‰çš„ Docker Swarm ç›¸å…³çš„å‘½ä»¤æ“ä½œã€‚ ä½†ä»¤äººæƒŠå¥‡çš„æ˜¯ï¼Œæˆ‘ä½¿ç”¨ <code>kubectl rollout restart</code> å’Œ <code>kubectl set image</code> è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½æ— æ³•ä¸ºå…ˆå‰åˆ›å»ºçš„ deployment è¿›è¡Œæ›´æ–°ï¼Œç”šè‡³æ˜¯ <code>kubectl apply</code> ä¹Ÿå¤±æ•ˆäº†ã€‚</p><p>ç”±äºè¿™äº›å‘½ä»¤èƒ½å¤Ÿæ­£ç¡®è¿”å›ï¼Œå¹¶æ²¡æœ‰æŠ¥é”™ï¼Œæ‰€ä»¥èµ·åˆæˆ‘æ²¡æœ‰æ‰©å¤§èŒƒå›´å»æ’æŸ¥å’Œ debugï¼Œæˆ‘ä»¥ä¸ºåªæ˜¯æˆ‘æ²¡æœ‰å¥½å¥½é˜…è¯»å¯¹äº <code>kubectl rollout restart</code> è¿™ä¸ªå‘½ä»¤çš„æè¿°æ–‡æ¡£è€Œå¯¼è‡´çš„ï¼Œè¿™è‡´ä½¿æˆ‘ä¸€ç›´åœ¨å°è¯•æŸ¥æ‰¾èµ„æ–™å’Œé˜…è¯» Issueã€æ–‡æ¡£ç­‰å†…å®¹æ¥åŠ æ·±ç†è§£å’Œå­¦ä¹ å…·ä½“çš„å·¥ä½œæ–¹å¼å’Œéœ€è¦æ³¨æ„çš„å†…å®¹ï¼Œä½†ç›´åˆ°æˆ‘å‘ç° KubeSphere æä¾›çš„ WebUIï¼Œä»¥åŠ <code>kubectl set image</code> å’Œ <code>kubectl apply</code> è¿™ä¸¤ä¸ªæ›´å¼ºåˆ¶çš„å‘½ä»¤éƒ½å¤±æ•ˆä¹‹åæ‰æç„¶å¤§æ‚Ÿï¼šä¹Ÿè®¸æ˜¯é›†ç¾¤ä¸Šå‡ºç°äº†ä»€ä¹ˆé—®é¢˜ã€‚</p><h2 id="æ’æŸ¥è¿‡ç¨‹" tabindex="-1">æ’æŸ¥è¿‡ç¨‹ <a class="header-anchor" href="#æ’æŸ¥è¿‡ç¨‹" aria-label="Permalink to &quot;æ’æŸ¥è¿‡ç¨‹&quot;">â€‹</a></h2><p>æˆ‘çœ‹äº†çœ‹æ¯ä¸€ä¸ª KubeSphere æ ¸å¿ƒç»„ä»¶çš„çŠ¶æ€ï¼Œå®ƒä»¬éƒ½æ˜¯æ­£å¸¸çš„ã€‚ ä¹Ÿæˆ–è®¸æ—¥å¿—é‡Œä¼šæœ‰ä»€ä¹ˆçº¿ç´¢ï¼Ÿäºæ˜¯æˆ‘çœ‹äº†çœ‹æä¾›ç”¨äºé›†ç¾¤ç®¡ç†çš„ API æ¥å£æœåŠ¡ <code>ks-apiserver</code>ï¼Œå‘ç°æœ‰è¿™ä¹ˆå‡ è¡Œé”™è¯¯ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>E1101 23:23:34.180786 1 utils.go:76] /workspace/pkg/kapis/resources/v1alpha3/handler.go:289 GET https://hub.example.com/v2/namespace/repo/manifests/latest: unexpected status code 401 Unauthorized: &lt;html&gt;</span></span>
<span class="line"><span>&lt;head&gt;&lt;title&gt;401 Authorization Required&lt;/title&gt;&lt;/head&gt;</span></span>
<span class="line"><span>&lt;body&gt;</span></span>
<span class="line"><span>&lt;center&gt;&lt;h1&gt;401 Authorization Required&lt;/h1&gt;&lt;/center&gt;</span></span>
<span class="line"><span>&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;</span></span>
<span class="line"><span>&lt;/body&gt;</span></span>
<span class="line"><span>&lt;/html&gt;</span></span></code></pre></div><p>è¿™çœ‹èµ·æ¥æ˜¯åœ¨è®¿é—®ç§æœ‰ Docker Registry çš„æ—¶å€™å‡ºç°çš„é—®é¢˜ï¼Œäºæ˜¯æˆ‘å» KubeSphere çš„ WebUI ä¸Šå°è¯•ç¼–è¾‘ deployment çš„å®¹å™¨é•œåƒæ¥å°è¯•è®© KubeSphere æ‹‰å–åˆ°é•œåƒçš„ä¿¡æ¯ï¼Œå‘ç°åœ¨ WebUI ä¸Šç¼–è¾‘å®¹å™¨é•œåƒçš„æ—¶å€™æ˜¯èƒ½å¤Ÿæ­£å¸¸æ‹‰å–é•œåƒå’Œé•œåƒ manifest ä¿¡æ¯çš„ï¼Œé‚£è¯´æ˜åº”è¯¥ä¸æ˜¯è¿™ä¸ªé—®é¢˜ï¼Œè‡³å°‘ä¸ä¼šæŠ¥ <code>401 Authorization Required</code> çš„é”™è¯¯ã€‚ é‚£ä¼šæ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å‘¢ï¼Ÿä¹Ÿè®¸æ˜¯ Kubernetes çš„æ ¸å¿ƒæœåŠ¡å‡ºäº†é—®é¢˜ï¼Ÿæˆ‘å»æ£€æŸ¥äº† <code>kube-controller-manager-svc</code> ï¼ˆç”¨äºå†…åµŒéš Kubernetes ä¸€èµ·å‘å¸ƒçš„æ ¸å¿ƒæ§åˆ¶å›è·¯ï¼‰çš„å®¹å™¨æ—¥å¿—ï¼Œç„¶åå‘ç°äº†è¿™ä¹ˆäº›é”™è¯¯å’Œä¿¡æ¯ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>I1101 23:26:30.165776 1 event.go:291] &quot;Event occurred&quot; object=&quot;namespace/service-v1-688965cd66&quot; kind=&quot;ReplicaSet&quot; apiVersion=&quot;apps/v1&quot; type=&quot;Warning&quot; reason=&quot;FailedCreate&quot; message=&quot;Error creating: Internal error occurred: failed calling webhook \\&quot;rev.object.sidecar-injector.istio.io\\&quot;: failed to call webhook: Post \\&quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s\\&quot;: service \\&quot;istiod-1-11-2\\&quot; not found&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>E1101 23:26:30.329218 1 replica_set.go:536] sync &quot;namespace/service-v1-688965cd66&quot; failed with Internal error occurred: failed calling webhook &quot;rev.object.sidecar-injector.istio.io&quot;: failed to call webhook: Post &quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s&quot;: service &quot;istiod-1-11-2&quot; not found</span></span>
<span class="line"><span></span></span>
<span class="line"><span>I1101 23:26:30.329252 1 event.go:291] &quot;Event occurred&quot; object=&quot;namespace/service-v1-688965cd66&quot; kind=&quot;ReplicaSet&quot; apiVersion=&quot;apps/v1&quot; type=&quot;Warning&quot; reason=&quot;FailedCreate&quot; message=&quot;Error creating: Internal error occurred: failed calling webhook \\&quot;rev.object.sidecar-injector.istio.io\\&quot;: failed to call webhook: Post \\&quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s\\&quot;: service \\&quot;istiod-1-11-2\\&quot; not found&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>E1101 23:26:30.651984 1 replica_set.go:536] sync &quot;namespace/service-v1-688965cd66&quot; failed with Internal error occurred: failed calling webhook &quot;rev.object.sidecar-injector.istio.io&quot;: failed to call webhook: Post &quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s&quot;: service &quot;istiod-1-11-2&quot; not found</span></span>
<span class="line"><span></span></span>
<span class="line"><span>I1101 23:26:30.652267 1 event.go:291] &quot;Event occurred&quot; object=&quot;namespace/service-v1-688965cd66&quot; kind=&quot;ReplicaSet&quot; apiVersion=&quot;apps/v1&quot; type=&quot;Warning&quot; reason=&quot;FailedCreate&quot; message=&quot;Error creating: Internal error occurred: failed calling webhook \\&quot;rev.object.sidecar-injector.istio.io\\&quot;: failed to call webhook: Post \\&quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s\\&quot;: service \\&quot;istiod-1-11-2\\&quot; not found&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>E1101 23:26:31.296499 1 replica_set.go:536] sync &quot;namespace/service-v1-688965cd66&quot; failed with Internal error occurred: failed calling webhook &quot;rev.object.sidecar-injector.istio.io&quot;: failed to call webhook: Post &quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s&quot;: service &quot;istiod-1-11-2&quot; not found</span></span>
<span class="line"><span></span></span>
<span class="line"><span>I1101 23:26:31.296517 1 event.go:291] &quot;Event occurred&quot; object=&quot;namespace/service-v1-688965cd66&quot; kind=&quot;ReplicaSet&quot; apiVersion=&quot;apps/v1&quot; type=&quot;Warning&quot; reason=&quot;FailedCreate&quot; message=&quot;Error creating: Internal error occurred: failed calling webhook \\&quot;rev.object.sidecar-injector.istio.io\\&quot;: failed to call webhook: Post \\&quot;https://istiod-1-11-2.istio-system.svc:443/inject?timeout=10s\\&quot;: service \\&quot;istiod-1-11-2\\&quot; not found&quot;</span></span></code></pre></div><p>çœ‹èµ·æ¥å¤§æ¦‚æ˜¯æ‰¾åˆ°äº†é—®é¢˜äº†ï¼Œä¸æˆ‘ä»¬éœ€è¦é…ç½®çš„ deployment åå­—ç›¸å…³ï¼Œä¹Ÿç¡®å®æ˜¯åœ¨æ‰§è¡Œ <code>ReplicaSet</code> æ“ä½œï¼Œä½†æ˜¯è¿™ä¸ª <code>failed calling webhook &quot;rev.object.sidecar-injector.istio.io&quot;</code> æ˜¯ä»€ä¹ˆé”™è¯¯å‘¢ï¼Ÿæˆ‘æƒ³èµ·æ¥æˆ‘ä¹‹å‰åœ¨å°è¯•é…ç½® KubeSphere çš„å¯æ’æ‹”ç»„ä»¶ Service Mesh çš„æ—¶å€™æœ‰æåˆ° Service Mesh æ˜¯ç”± Istio æä¾›çš„ï¼Œä¹Ÿè®¸æ˜¯åœ¨æˆ‘åæ¥å¸è½½ Service Mesh å¯æ’æ‹”ç»„ä»¶çš„æ—¶å€™æ²¡æœ‰å®Œå…¨æ¸…ç†å®Œèµ„æºå¯¼è‡´çš„ï¼Ÿ æˆ‘å°è¯•æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªé”™è¯¯ï¼Œå‘ç°æŒºå¤šäººé‡åˆ°çš„ã€‚ä½†è§£å†³èµ·æ¥ä¹Ÿéå¸¸ç®€å•å°±æ˜¯äº†ã€‚</p><h2 id="è§£å†³é—®é¢˜" tabindex="-1">è§£å†³é—®é¢˜ <a class="header-anchor" href="#è§£å†³é—®é¢˜" aria-label="Permalink to &quot;è§£å†³é—®é¢˜&quot;">â€‹</a></h2><p>æˆ‘ä»¬éœ€è¦æ£€æŸ¥ä¸¤ä¸ªèµ„æºï¼Œåˆ†åˆ«æ˜¯ <code>ValidatingWebhookConfiguration</code> å’Œ <code>MutatingWebhookConfiguration</code>ï¼Œä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å°±èƒ½çœ‹åˆ°ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ValidatingWebhookConfiguration</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                                          WEBHOOKS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">istio-validator-1-11-2-istio-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">           2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          8d</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MutatingWebhookConfiguration</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                            WEBHOOKS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">istio-sidecar-injector-1-11-2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          8d</span></span></code></pre></div><p>æ¥ä¸‹æ¥åªéœ€è¦è¿è¡Œä¸‹é¢çš„ä¸¤ä¸ªå‘½ä»¤å°±èƒ½æ¸…ç†æ‰é”™è¯¯çš„èµ„æºäº†ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ValidatingWebhookConfiguration</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> istio-validator-1-11-2-istio-system</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MutatingWebhookConfiguration</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> istio-sidecar-injector-1-11-2</span></span></code></pre></div><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1">å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2>`,17);function f(F,S,K,j,E,P){const n=o("NolebasePageProperties"),a=o("VPNolebaseInlineLinkPreview"),l=o("NolebaseGitContributors"),r=o("NolebaseGitChangelog");return h(),c("div",null,[k,s(n),b,e("table",g,[q,e("tbody",null,[e("tr",null,[v,_,e("td",null,[s(a,{href:"https://kubesphere.io/zh/docs/v3.3/",target:"_blank",rel:"noreferrer"},{default:i(()=>[t("https://kubesphere.io/zh/docs/v3.3/")]),_:1})])]),e("tr",null,[m,y,e("td",null,[s(a,{href:"https://v1-22.docs.kubernetes.io/",target:"_blank",rel:"noreferrer"},{default:i(()=>[t("https://v1-22.docs.kubernetes.io/")]),_:1})])])])]),C,e("p",null,[s(a,{href:"https://kubesphere.com.cn/forum/d/7378-istio",target:"_blank",rel:"noreferrer"},{default:i(()=>[t("å¸è½½istioç»„ä»¶ä¹‹åå‡ºç°é—®é¢˜ - KubeSphere å¼€å‘è€…ç¤¾åŒº")]),_:1})]),e("p",null,[s(a,{href:"https://blog.csdn.net/xiaoxiaosu1996/article/details/122873848",target:"_blank",rel:"noreferrer"},{default:i(()=>[t("è®°å½•k8sä¸­å®‰è£…kubeSphereçš„ä¸€äº›é—®é¢˜_xiaoxiaosu1996çš„åšå®¢-CSDNåšå®¢")]),_:1})]),e("p",null,[s(a,{href:"https://blog.csdn.net/shandian534/article/details/125987789",target:"_blank",rel:"noreferrer"},{default:i(()=>[t("kubesphere å¸è½½ istioå éƒ¨ç½²æœåŠ¡ä¸€ç›´å¤„ç†é˜Ÿåˆ—ä¸­_å±±å·…çš„åšå®¢-CSDNåšå®¢_kubesphere é˜Ÿåˆ—ä¸­")]),_:1})]),s(l),s(r)])}const I=p(u,[["render",f]]);export{w as __pageData,I as default};
