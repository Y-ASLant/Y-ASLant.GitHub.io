import{_ as k,c as d,I as s,j as i,w as t,a as n,au as o,D as a,o as r}from"./chunks/framework.RMxno62p.js";const x=JSON.parse('{"title":"æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚","description":"","frontmatter":{"tags":["è®¡ç®—æœº/ç½‘ç»œ/ç½‘å…³/Nginx","è®¡ç®—æœº/ç½‘ç»œ/ç½‘å…³","å‘½ä»¤è¡Œ/apt","æ“ä½œç³»ç»Ÿ/Debian","æ“ä½œç³»ç»Ÿ/Debian/Debian-11","æ“ä½œç³»ç»Ÿ/Debian/Debian-12","è®¡ç®—æœº/ç½‘ç»œ/åè®®/TCP","è®¡ç®—æœº/ç½‘ç»œ/åè®®/UDP","å‘½ä»¤è¡Œ/ç»ˆç«¯","è¿ç»´/ç½‘ç»œ","åŸºç¡€è®¾æ–½/Homelab","å¼€å‘/æ•…éšœæ’æŸ¥"]},"headers":[],"relativePath":"ç¬”è®°/ğŸ›ï¸ æ“ä½œç³»ç»Ÿ/ğŸ¥ Debian/æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚.md","filePath":"ç¬”è®°/ğŸ›ï¸ æ“ä½œç³»ç»Ÿ/ğŸ¥ Debian/æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚.md"}'),g={name:"ç¬”è®°/ğŸ›ï¸ æ“ä½œç³»ç»Ÿ/ğŸ¥ Debian/æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚.md"},c=i("h1",{id:"æ¿€æ´»-debian-ä¸Šå®‰è£…çš„-nginx-çš„-stream-æ¨¡å—æ¥æ”¯æŒè½¬å‘-tcp-å’Œ-udp-è¯·æ±‚",tabindex:"-1"},[n("æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚ "),i("a",{class:"header-anchor",href:"#æ¿€æ´»-debian-ä¸Šå®‰è£…çš„-nginx-çš„-stream-æ¨¡å—æ¥æ”¯æŒè½¬å‘-tcp-å’Œ-udp-è¯·æ±‚","aria-label":'Permalink to "æ¿€æ´» Debian ä¸Šå®‰è£…çš„ Nginx çš„ Stream æ¨¡å—æ¥æ”¯æŒè½¬å‘ TCP å’Œ UDP è¯·æ±‚"'},"â€‹")],-1),C=o(`<h2 id="tl-dr" tabindex="-1">TL;DR <a class="header-anchor" href="#tl-dr" aria-label="Permalink to &quot;TL;DR&quot;">â€‹</a></h2><p>å®‰è£… <code>libnginx-mod-stream</code> æ¨¡å—æ¥æ”¯æŒ Nginx çš„ <code>stream</code> åŠŸèƒ½ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> libnginx-mod-stream</span></span></code></pre></div><p>æŠŠ Nginx æ ¹é…ç½®æ–‡ä»¶å…³è”çš„ <code>/etc/nginx/modules-enabled/*.conf</code> çš„ <code>50-mod-stream.conf.removed</code> æ¢å¤ä¸º <code>50-mod-stream.conf</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf.removed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf</span></span></code></pre></div><p>ç„¶åç»§ç»­ä½¿ç”¨ <code>stream</code> å—å°±å¥½äº†ã€‚</p><h2 id="èƒŒæ™¯" tabindex="-1">èƒŒæ™¯ <a class="header-anchor" href="#èƒŒæ™¯" aria-label="Permalink to &quot;èƒŒæ™¯&quot;">â€‹</a></h2><p>ä»Šå¤©åœ¨åˆšå‡çº§è¿‡çš„ Debian ç½‘å…³è®¾å¤‡ä¹‹åè®¿é—® TCP/UDP æœåŠ¡çš„æ—¶å€™é­é‡äº†å‘èµ·è¿æ¥çš„å®¢æˆ·ç«¯æŠ¥é”™</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>Couldn&#39;t connect to server</span></span></code></pre></div><p>çš„é—®é¢˜ï¼Œæ£€æŸ¥äº†ä¸€ä¸‹ä¹‹åå‘ç°æ˜¯å› ä¸ºä¹‹å‰ç¼–å†™å’Œè¡¥å……è¿›å»çš„ TCP/UDP ä»£ç†ç”¨åˆ°çš„ <code>stream</code> å—å¤±è¸ªäº†ï¼Œæˆ‘æ€€ç–‘å¯èƒ½å’Œå‡çº§ä¹‹åçš„ Nginx ç‰ˆæœ¬ä¸‹çš„é…ç½®æ–‡ä»¶ä¿®æ”¹æœ‰ä¸€å®šçš„å…³ç³»ã€‚</p><p>åœ¨å‡çº§ä¹‹å‰ï¼Œæˆ‘æ˜¯è¿™æ ·ç¼–å†™çš„ Nginx æ ¹é…ç½®æ–‡ä»¶ <code>nginx.conf</code>ï¼š</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	include </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/etc/nginx/tcp.d/*.conf;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>å¦‚æœç›´æ¥æŠŠ <code>stream</code> ä¿®è¡¥è¿›æ¥ï¼Œæ‰§è¡Œ</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -t</span></span></code></pre></div><p>å»æ£€æŸ¥ Nginx é…ç½®æ–‡ä»¶æœ‰æ•ˆæ€§çš„è¯ï¼Œå°±ä¼šå‘ç°ä¸‹é¢è¿™æ ·çš„é”™è¯¯</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -t</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">2023/12/03</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 19:11:44</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [emerg] 2855#2855: unknown directive </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;stream&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> in /etc/nginx/nginx.conf:62</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nginx:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> configuration</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/nginx.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> failed</span></span></code></pre></div><p>é‚£ <code>stream</code> ä¸¢å¤±çš„è¯åº”è¯¥æ˜¯å’Œ Nginx çš„ç¼–è¯‘æ¨¡å—ç›¸å…³ï¼Ÿ</p><p>æˆ‘åˆæ£€æŸ¥äº†ä¸€ä¸‹</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -V</span></span></code></pre></div><p>çš„è¾“å‡ºï¼Œå‘ç° <code>--with-stream=dynamic</code> æ˜¯å­˜åœ¨çš„ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -V</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx/1.22.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">built</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OpenSSL</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3.0.8</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Feb</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2023</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (running </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">with</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OpenSSL</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3.0.11</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 19</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Sep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2023</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TLS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SNI</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> support</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> enabled</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">configure</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> arguments:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-cc-opt=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;-g -O2 -ffile-prefix-map=/build/nginx-AoTv4W/nginx-1.22.1=. -fstack-protector-strong -Wformat -Werror=format-security -fPIC -Wdate-time -D_FORTIFY_SOURCE=2&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-ld-opt=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;-Wl,-z,relro -Wl,-z,now -fPIC&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --prefix=/usr/share/nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --conf-path=/etc/nginx/nginx.conf</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-log-path=/var/log/nginx/access.log</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --error-log-path=stderr</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --lock-path=/var/lock/nginx.lock</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --pid-path=/run/nginx.pid</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --modules-path=/usr/lib/nginx/modules</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-client-body-temp-path=/var/lib/nginx/body</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-fastcgi-temp-path=/var/lib/nginx/fastcgi</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-proxy-temp-path=/var/lib/nginx/proxy</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-scgi-temp-path=/var/lib/nginx/scgi</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --http-uwsgi-temp-path=/var/lib/nginx/uwsgi</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-compat</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-debug</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-pcre-jit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_ssl_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_stub_status_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_realip_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_auth_request_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_v2_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_dav_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_slice_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-threads</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_addition_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_flv_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_gunzip_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_gzip_static_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_mp4_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_random_index_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_secure_link_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_sub_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-mail_ssl_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-stream_ssl_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-stream_ssl_preread_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-stream_realip_module</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_geoip_module=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_image_filter_module=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_perl_module=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-http_xslt_module=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-mail=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-stream=dynamic</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --with-stream_geoip_module=dynamic</span></span></code></pre></div><p>ä½†æ˜¯æˆ‘ä¼¼ä¹å¤ªä¹…æ²¡æœ‰æè¿‡è¿™éƒ¨åˆ†çš„é…ç½®äº†ï¼Œä¸å¤ªè®°å¾— <code>dynamic</code> ä»£è¡¨äº†ä»€ä¹ˆï¼Œäºæ˜¯å»æœç´¢äº†ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œå‘ç°åœ¨ <code>--with-stream=dynamic</code> çš„æƒ…å†µä¸‹ï¼Œéœ€è¦é€šè¿‡ç”¨æˆ·æ‰‹åŠ¨å¼•å…¥ä¾èµ–çš„ <code>so</code> åº“æ–‡ä»¶æ‰èƒ½è®©è¿™ä¸ªæ¨¡å—æ­£å¸¸å·¥ä½œï¼š</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">load_module </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/usr/lib/nginx/modules/ngx_stream_module.so;</span></span></code></pre></div><h2 id="è§£å†³" tabindex="-1">è§£å†³ <a class="header-anchor" href="#è§£å†³" aria-label="Permalink to &quot;è§£å†³&quot;">â€‹</a></h2><p>æˆ‘åˆæ£€æŸ¥äº†ä¸€ä¸‹ Nginx çš„æ ¹é…ç½®æ–‡ä»¶ <code>nginx.conf</code>ï¼Œå‘ç°å†…éƒ¨æ˜¯å¯¹æ¨¡å—æœ‰å¯é€‰é…ç½®çš„æ–‡ä»¶å®šä¹‰çš„ï¼š</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light one-dark-pro has-highlighted vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">user </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">www-data;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">worker_processes </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">auto;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">pid </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/run/nginx.pid;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/var/log/nginx/error.log;</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">include </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/etc/nginx/modules-enabled/*.conf; </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">events</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	worker_connections </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">768</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	# multi_accept on;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™æˆ‘å» <code>/etc/nginx/modules-enabled/</code> ç›®å½•ä¸‹é¢æ‰¾åˆ°äº†è¿™ä¸ª <code>stream</code> æ¨¡å—ç›¸å…³çš„å®šä¹‰æ–‡ä»¶ï¼š<code>/etc/nginx/modules-enabled/50-mod-stream.conf.removed</code>ï¼Œä½†å¦‚æœç›´æ¥é€šè¿‡</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf.removed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf</span></span></code></pre></div><p>è¿™ä¸ªæ–‡ä»¶å»å°è¯•å°† <code>removed</code> çš„æ¨¡å—æ¿€æ´»çš„è¯ï¼Œä¼šé‡åˆ° <code>æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</code> çš„é”™è¯¯ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘åˆå»æ£€æŸ¥äº†è¿™ä¸ªæ–‡ä»¶å…·ä½“æ˜¯é“¾æ¥åˆ°äº†å“ªé‡Œï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -la</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf.removed</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lrwxrwxrwx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 2022å¹´</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 6æœˆ14æ—¥</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/nginx/modules-enabled/50-mod-stream.conf.removed</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/nginx/modules-available/mod-stream.conf</span></span></code></pre></div><p>å‘ç°å®ƒç¡®å®æ˜¯ä¸€ä¸ªè½¯é“¾æ¥ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬é€šè¿‡ <code>cat</code> æ¥è§‚å¯Ÿ <code>/usr/share/nginx/modules-available/mod-stream.conf</code> çš„è¯å°±å¯ä»¥éªŒè¯æ²¡æœ‰è¿™ä¸ªé…ç½®æ–‡ä»¶çš„é—®é¢˜ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/nginx/modules-available/mod-stream.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cat:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /usr/share/nginx/modules-available/mod-stream.conf:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</span></span></code></pre></div><p>æˆ‘ç”¨</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span></span></code></pre></div><p>æ‰¾åˆ°äº† <code>stream</code> æ¨¡å—éœ€è¦çš„åŒ…ï¼Œæ¥ä¸‹æ¥å®‰è£…å°±å¥½äº†ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> libnginx-mod-stream</span></span></code></pre></div><p>å®‰è£…ç»“æŸä¹‹åæˆ‘ä»¬å†æ¬¡æ¢å¤åŸå…ˆ Nginx æ ¹é…ç½®æ–‡ä»¶ <code>nginx.conf</code> ä¸‹é¢çš„ <code>stream</code> æ¨¡å—ç›¸å…³çš„å®šä¹‰ï¼š</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">stream</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">	include </span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">/etc/nginx/tcp.d/*.conf;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>å†æ¬¡è¿è¡Œ</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -t</span></span></code></pre></div><p>æœ€ç»ˆå°±å‘ç°å®ƒèƒ½æ­£å¸¸å·¥ä½œäº†ï¼</p><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1">å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2>`,42);function y(m,u,b,F,D,_){const l=a("NolebasePageProperties"),e=a("VPNolebaseInlineLinkPreview"),h=a("NolebaseGitContributors"),p=a("NolebaseGitChangelog");return r(),d("div",null,[c,s(l),C,i("ul",null,[i("li",null,[s(e,{href:"https://stackoverflow.com/questions/50850900/nginx-unknown-directive-stream",target:"_blank",rel:"noreferrer"},{default:t(()=>[n("udp - NGINX Unknown Directive Stream - Stack Overflow")]),_:1})]),i("li",null,[s(e,{href:"https://serverfault.com/questions/858067/unknown-directive-stream-in-etc-nginx-nginx-conf86",target:"_blank",rel:"noreferrer"},{default:t(()=>[n('unknown directive "stream" in /etc/nginx/nginx.conf:86 - Server Fault')]),_:1})])]),s(h),s(p)])}const A=k(g,[["render",y]]);export{x as __pageData,A as default};
