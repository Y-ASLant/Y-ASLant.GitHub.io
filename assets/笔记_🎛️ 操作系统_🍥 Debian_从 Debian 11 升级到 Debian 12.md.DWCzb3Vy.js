import{_ as n,c as p,I as s,j as e,a as h,au as o,D as a,o as d}from"./chunks/framework.RMxno62p.js";const D=JSON.parse('{"title":"从 Debian 11 升级到 Debian 12","description":"","frontmatter":{"tags":["命令行/终端","命令行/apt","命令行","操作系统/Debian","操作系统/Debian/Debian-11","操作系统/Debian/Debian-12","运维","基础设施/Homelab","运维/物理机","运维/内核"]},"headers":[],"relativePath":"笔记/🎛️ 操作系统/🍥 Debian/从 Debian 11 升级到 Debian 12.md","filePath":"笔记/🎛️ 操作系统/🍥 Debian/从 Debian 11 升级到 Debian 12.md"}'),c={name:"笔记/🎛️ 操作系统/🍥 Debian/从 Debian 11 升级到 Debian 12.md"},k=e("h1",{id:"从-debian-11-升级到-debian-12",tabindex:"-1"},[h("从 Debian 11 升级到 Debian 12 "),e("a",{class:"header-anchor",href:"#从-debian-11-升级到-debian-12","aria-label":'Permalink to "从 Debian 11 升级到 Debian 12"'},"​")],-1),r=o('<h2 id="先检查升级来源是否是-debian-11" tabindex="-1">先检查升级来源是否是 Debian 11 <a class="header-anchor" href="#先检查升级来源是否是-debian-11" aria-label="Permalink to &quot;先检查升级来源是否是 Debian 11&quot;">​</a></h2><p>查看发行版信息</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><p>查看内核版本</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -mrs</span></span></code></pre></div><p>查看 Debian 版本</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/debian_version</span></span></code></pre></div><h2 id="备份系统" tabindex="-1">备份系统 <a class="header-anchor" href="#备份系统" aria-label="Permalink to &quot;备份系统&quot;">​</a></h2><h2 id="查看和确认现在安装的-apt-包" tabindex="-1">查看和确认现在安装的 <code>apt</code> 包 <a class="header-anchor" href="#查看和确认现在安装的-apt-包" aria-label="Permalink to &quot;查看和确认现在安装的 `apt` 包&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>sudo apt list &#39;?narrow(?installed, ?not(?origin(Debian)))&#39;</span></span></code></pre></div><h2 id="更新当前系统到最新-debian-11" tabindex="-1">更新当前系统到最新 Debian 11 <a class="header-anchor" href="#更新当前系统到最新-debian-11" aria-label="Permalink to &quot;更新当前系统到最新 Debian 11&quot;">​</a></h2><h3 id="更新软件源-index" tabindex="-1">更新软件源 index <a class="header-anchor" href="#更新软件源-index" aria-label="Permalink to &quot;更新软件源 index&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span></code></pre></div><h3 id="更新可更新的包" tabindex="-1">更新可更新的包 <a class="header-anchor" href="#更新可更新的包" aria-label="Permalink to &quot;更新可更新的包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> upgrade</span></span></code></pre></div><h3 id="系统更新" tabindex="-1">系统更新 <a class="header-anchor" href="#系统更新" aria-label="Permalink to &quot;系统更新&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> full-upgrade</span></span></code></pre></div><h3 id="移除可自动移除的包" tabindex="-1">移除可自动移除的包 <a class="header-anchor" href="#移除可自动移除的包" aria-label="Permalink to &quot;移除可自动移除的包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --purge</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> autoremove</span></span></code></pre></div><h3 id="重启并应用-debian-11-系统更新造成的变更" tabindex="-1">重启并应用 Debian 11 系统更新造成的变更 <a class="header-anchor" href="#重启并应用-debian-11-系统更新造成的变更" aria-label="Permalink to &quot;重启并应用 Debian 11 系统更新造成的变更&quot;">​</a></h3><p>一般而言可能会涉及到 <code>grub</code> 变更，或者别的 <code>systemd</code> 变更，这个时候可以重启应用一下现在的 Debian 11 更新</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>sudo reboot</span></span></code></pre></div><h2 id="将-apt-软件源从-bullseye-更新到-bookworm" tabindex="-1">将 <code>apt</code> 软件源从 <code>bullseye</code> 更新到 <code>bookworm</code> <a class="header-anchor" href="#将-apt-软件源从-bullseye-更新到-bookworm" aria-label="Permalink to &quot;将 `apt` 软件源从 `bullseye` 更新到 `bookworm`&quot;">​</a></h2><p>首先是更新一下基础软件源，开始之前可以看一眼，确认一下内容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list</span></span></code></pre></div><p>执行下面的操作之前，我们还是备份一下 <code>/etc/apt/sources.list</code> 本身：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /root/sources.list-backup.11.bullseye</span></span></code></pre></div><p>可以用下面的命令全自动替换并且自动生成一个 <code>.bak</code> 文件作为备份：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;.bak&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;s/bullseye/bookworm/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list</span></span></code></pre></div><p>也可以自己通过</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list</span></span></code></pre></div><p>进行手动修改和替换。</p><p>修改之后可以再看看有没有改错呢：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list</span></span></code></pre></div><h2 id="将其他-apt-软件源从-bullseye-或者-deb-11-的引用更新到-bookworm-和-deb-12" tabindex="-1">将其他 <code>apt</code> 软件源从 <code>bullseye</code> 或者 <code>deb/11</code> 的引用更新到 <code>bookworm</code> 和 <code>deb/12</code> <a class="header-anchor" href="#将其他-apt-软件源从-bullseye-或者-deb-11-的引用更新到-bookworm-和-deb-12" aria-label="Permalink to &quot;将其他 `apt` 软件源从 `bullseye` 或者 `deb/11` 的引用更新到 `bookworm` 和 `deb/12`&quot;">​</a></h2><p>记得检查一下其他拓展的软件源配置文件，比如 Docker，Kubernetes，Plex Media Server 这样的软件，这些拓展的软件源配置文件通常存放在：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/etc/apt/sources.list.d/</span></span></code></pre></div><p>目录下面，可以通过</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -la</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/</span></span></code></pre></div><p>查看</p><h3 id="更新-docker-的-apt-软件源" tabindex="-1">更新 Docker 的 <code>apt</code> 软件源 <a class="header-anchor" href="#更新-docker-的-apt-软件源" aria-label="Permalink to &quot;更新 Docker 的 `apt` 软件源&quot;">​</a></h3><p>开始之前可以看一眼，确认一下内容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span></span></code></pre></div><p>执行下面的操作之前，我们还是备份一下 <code>/etc/apt/sources.list.d/docker.list</code> 本身：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /root/sources.list.docker.list-backup.11.bullseye</span></span></code></pre></div><p>可以用下面的命令全自动替换并且自动生成一个 <code>.bak</code> 文件作为备份：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sed</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;.bak&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;s/bullseye/bookworm/g&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span></span></code></pre></div><p>也可以自己通过</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span></span></code></pre></div><p>进行手动修改和替换。</p><p>修改之后可以再看看有没有改错呢：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/apt/sources.list.d/docker.list</span></span></code></pre></div><h2 id="更新到-debian-12" tabindex="-1">更新到 Debian 12 <a class="header-anchor" href="#更新到-debian-12" aria-label="Permalink to &quot;更新到 Debian 12&quot;">​</a></h2><h3 id="尝试索引和更新-debian-12-bookworm-相关的软件源" tabindex="-1">尝试索引和更新 Debian 12 Bookworm 相关的软件源 <a class="header-anchor" href="#尝试索引和更新-debian-12-bookworm-相关的软件源" aria-label="Permalink to &quot;尝试索引和更新 Debian 12 Bookworm 相关的软件源&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span></code></pre></div><h3 id="更新-debian-12-软件源下新更新的包" tabindex="-1">更新 Debian 12 软件源下新更新的包 <a class="header-anchor" href="#更新-debian-12-软件源下新更新的包" aria-label="Permalink to &quot;更新 Debian 12 软件源下新更新的包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> upgrade</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --without-new-pkgs</span></span></code></pre></div><h3 id="系统更新到-debian-12-相关的包" tabindex="-1">系统更新到 Debian 12 相关的包 <a class="header-anchor" href="#系统更新到-debian-12-相关的包" aria-label="Permalink to &quot;系统更新到 Debian 12 相关的包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> full-upgrade</span></span></code></pre></div><h3 id="移除可自动移除的包-1" tabindex="-1">移除可自动移除的包 <a class="header-anchor" href="#移除可自动移除的包-1" aria-label="Permalink to &quot;移除可自动移除的包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --purge</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> autoremove</span></span></code></pre></div><h2 id="更新完成-准备重启" tabindex="-1">更新完成，准备重启 <a class="header-anchor" href="#更新完成-准备重启" aria-label="Permalink to &quot;更新完成，准备重启&quot;">​</a></h2><p>重启前，为了避免 SSHD（SSH Server 的服务）出现问题和异常导致我们无法连接到远端机器，可以先用</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sshd</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -t</span></span></code></pre></div><p>检查一下 <code>sshd</code> 相关的配置文件。</p><p>然后执行重启吧！</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> reboot</span></span></code></pre></div><h2 id="检查是否更新完成" tabindex="-1">检查是否更新完成 <a class="header-anchor" href="#检查是否更新完成" aria-label="Permalink to &quot;检查是否更新完成&quot;">​</a></h2><p>查看发行版信息</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lsb_release</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><p>查看内核版本</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -mrs</span></span></code></pre></div><p>查看 Debian 版本</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/debian_version</span></span></code></pre></div>',74);function b(g,u,C,v,y,F){const i=a("NolebasePageProperties"),t=a("NolebaseGitContributors"),l=a("NolebaseGitChangelog");return d(),p("div",null,[k,s(i),r,s(t),s(l)])}const x=n(c,[["render",b]]);export{D as __pageData,x as default};
