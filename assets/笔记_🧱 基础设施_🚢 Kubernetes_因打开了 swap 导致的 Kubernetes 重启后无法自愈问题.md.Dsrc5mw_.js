import{_ as d,c as o,I as i,j as s,w as n,a,au as l,D as t,o as r}from"./chunks/framework.RMxno62p.js";const x=JSON.parse('{"title":"å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜","description":"","frontmatter":{"tags":["å¼€å‘/äº‘åŸç”Ÿ/Kubernetes","å‘½ä»¤è¡Œ/kubectl","è½¯ä»¶/äº‘åŸç”Ÿ/kubelet","å‘½ä»¤è¡Œ/systemd","å‘½ä»¤è¡Œ/journalctl","è®¡ç®—æœºç§‘å­¦/å†…å­˜/è™šæ‹Ÿå†…å­˜","è®¡ç®—æœºç§‘å­¦/å†…å­˜/è™šæ‹Ÿå†…å­˜/swap","å‘½ä»¤è¡Œ/docker","å¼€å‘/å®¹å™¨åŒ–/Docker","å¼€å‘/äº‘åŸç”Ÿ/Docker","è½¯ä»¶/äº‘åŸç”Ÿ/docker","è®¡ç®—æœº/æ“ä½œç³»ç»Ÿ/Linux","æ“ä½œç³»ç»Ÿ/Linux"]},"headers":[],"relativePath":"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜.md","filePath":"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜.md"}'),c={name:"ç¬”è®°/ğŸ§± åŸºç¡€è®¾æ–½/ğŸš¢ Kubernetes/å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜.md"},g=s("h1",{id:"å› æ‰“å¼€äº†-swap-å¯¼è‡´çš„-kubernetes-é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜",tabindex:"-1"},[a("å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜ "),s("a",{class:"header-anchor",href:"#å› æ‰“å¼€äº†-swap-å¯¼è‡´çš„-kubernetes-é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜","aria-label":'Permalink to "å› æ‰“å¼€äº† swap å¯¼è‡´çš„ Kubernetes é‡å¯åæ— æ³•è‡ªæ„ˆé—®é¢˜"'},"â€‹")],-1),u=s("h3",{id:"æ–‡æ¡£å…¼å®¹æ€§",tabindex:"-1"},[a("æ–‡æ¡£å…¼å®¹æ€§ "),s("a",{class:"header-anchor",href:"#æ–‡æ¡£å…¼å®¹æ€§","aria-label":'Permalink to "æ–‡æ¡£å…¼å®¹æ€§"'},"â€‹")],-1),y={tabindex:"0"},C=s("thead",null,[s("tr",null,[s("th",null,"ä¸»ä½“"),s("th",null,"ç‰ˆæœ¬å·"),s("th",null,"æ–‡æ¡£åœ°å€ï¼ˆå¦‚æœæœ‰ï¼‰")])],-1),F=s("td",null,"Kubernetes",-1),b=s("td",null,"v1.22.1",-1),v=l(`<h2 id="è¯´æ˜" tabindex="-1">è¯´æ˜ <a class="header-anchor" href="#è¯´æ˜" aria-label="Permalink to &quot;è¯´æ˜&quot;">â€‹</a></h2><p>æœºå™¨é‡å¯ä¹‹åå‘ç° docker é‡Œé¢å’Œ k8s ç›¸å…³çš„å®¹å™¨éƒ½æ²¡æœ‰å¯åŠ¨èµ·æ¥ï¼Œç­‰äº†å¥½ä¹…ä¹Ÿæ²¡æœ‰è§æœ‰ååº”ã€‚</p><h2 id="æ’æŸ¥" tabindex="-1">æ’æŸ¥ <a class="header-anchor" href="#æ’æŸ¥" aria-label="Permalink to &quot;æ’æŸ¥&quot;">â€‹</a></h2><p>é€šè¿‡ <code>systemctl status docker</code> å’Œ <code>journalctl -xef -u docker</code> æŸ¥çœ‹ docker çš„çŠ¶æ€å’Œæ—¥å¿—ä¹Ÿæ²¡æœ‰å‘ç°é—®é¢˜ã€‚</p><p>ä½¿ç”¨ <code>kubectl get nodes</code> æ—¶èƒ½çœ‹åˆ°èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯ <code>NotReady</code>ï¼Œå¦‚æœä½¿ç”¨ <code>kubectl describe node &lt;èŠ‚ç‚¹åç§°&gt;</code> çš„è¯è¿˜èƒ½åœ¨ <code>MemoryPressure</code> å’Œå…¶ä»–çŠ¶æ€æ ä¸­çœ‹åˆ° <code>NodeStatusUnknown</code> å’Œ <code>kubelet stopped posting node status</code> çš„æŠ¥é”™ã€‚</p><p>æŸ¥é˜…èµ„æ–™çš„æ—¶å€™å‘ç°æœ‰äººæ¨èç”¨ <code>journalctl</code> çœ‹ä¸€ä¸‹ <code>kubectl</code> çš„æ—¥å¿—å’ŒæŠ¥é”™é—®é¢˜ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubelet</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span></span></code></pre></div><p>ç„¶åå°±å‘ç°äº†ä¸‹é¢çš„æ—¥å¿—ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>11æœˆ 26 16:37:46 node01 systemd[1]: kubelet.service: Main process exited, code=exited, status=1/FAILURE</span></span>
<span class="line"><span>11æœˆ 26 16:37:46 node01 systemd[1]: kubelet.service: Failed with result &#39;exit-code&#39;.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 systemd[1]: kubelet.service: Scheduled restart job, restart counter is at 66.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 systemd[1]: Stopped kubelet: The Kubernetes Node Agent.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 systemd[1]: Started kubelet: The Kubernetes Node Agent.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: Flag --cgroup-driver has been deprecated, This parameter should be set via the config file specified by the Kubelet&#39;s --config flag. See https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ for more information.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: Flag --network-plugin has been deprecated, will be removed along with dockershim.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: Flag --cgroup-driver has been deprecated, This parameter should be set via the config file specified by the Kubelet&#39;s --config flag. See https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/ for more information.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: Flag --network-plugin has been deprecated, will be removed along with dockershim.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: I1126 16:37:56.617346    5885 server.go:440] &quot;Kubelet version&quot; kubeletVersion=&quot;v1.22.12&quot;</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: I1126 16:37:56.617883    5885 server.go:868] &quot;Client rotation is on, will bootstrap in background&quot;</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: I1126 16:37:56.625503    5885 certificate_store.go:130] Loading cert/key pair from &quot;/var/lib/kubelet/pki/kubelet-client-current.pem&quot;.</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: I1126 16:37:56.627583    5885 dynamic_cafile_content.go:155] &quot;Starting controller&quot; name=&quot;client-ca-bundle::/etc/kubernetes/pki/ca.crt&quot;</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: W1126 16:37:56.627625    5885 manager.go:159] Cannot detect current cgroup on cgroup v2</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: I1126 16:37:56.750278    5885 server.go:687] &quot;--cgroups-per-qos enabled, but --cgroup-root was not specified.  defaulting to /&quot;</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 kubelet[5885]: E1126 16:37:56.750615    5885 server.go:294] &quot;Failed to run kubelet&quot; err=&quot;failed to run Kubelet: running with swap on is not supported, please disable swap! or set --fail-swap-on flag to false. /proc/swaps contained: [Filename\\t\\t\\t\\tType\\t\\tSize\\t\\tUsed\\t\\tPriority /dev/sda3                               partition\\t999420\\t\\t0\\t\\t-2]&quot;</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 systemd[1]: kubelet.service: Main process exited, code=exited, status=1/FAILURE</span></span>
<span class="line"><span>11æœˆ 26 16:37:56 node01 systemd[1]: kubelet.service: Failed with result &#39;exit-code&#39;.</span></span></code></pre></div><p>æœ€å…³é”®çš„ä¿¡æ¯æ˜¯è¿™ä¸€æ¡ï¼š</p><blockquote><p>Failed to run kubelet&quot; err=&quot;failed to run Kubelet: running with swap on is not supported, please disable swap! or set --fail-swap-on flag to false.</p></blockquote><p>è¯¥æŠ¥é”™æŒ‡æ˜äº† Kubernetes æ— æ³•åœ¨ swap å¼€å¯çš„æ—¶å€™è¿è¡Œ kubeletï¼Œæˆ‘ä»¬è¦ä¹ˆå…³é—­ swapï¼Œè¦ä¹ˆåœ¨ kubelet ç›¸å…³çš„è®¾ç½®ä¸­é…ç½®å…¶å‘½ä»¤è¡Œå‚æ•° <code>--fail-swap-on</code>ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>swapoff -a</code> å‘½ä»¤å¿«é€Ÿå…³é—­ swap æ¥æµ‹è¯•æ˜¯å¦èƒ½æ¢å¤ï¼Œå¦‚æœå¯ä»¥ï¼Œæˆ‘ä»¬è¿˜èƒ½è¿›ä¸€æ­¥é…ç½®å…¶å‘½ä»¤è¡Œå‚æ•° <code>--fail-swap-on</code> æ¥é¿å…ä¸æ­£ç¡®çš„é…ç½®å¯¼è‡´çš„ Kubernetes è‡ªæ„ˆé—®é¢˜ã€‚</p><p>é€šè¿‡æ‰§è¡Œ <code>swapoff -a</code> ä¹‹åæˆ‘ä»¬å†æ¬¡ä½¿ç”¨ <code>docker ps</code> æ¥æ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€å°±èƒ½å‘ç°å·²ç»æœ‰éƒ¨åˆ†å®¹å™¨å¼€å§‹é‡å¯å¹¶æ¢å¤åˆ° UP çŠ¶æ€äº†ã€‚</p><h2 id="è§£å†³" tabindex="-1">è§£å†³ <a class="header-anchor" href="#è§£å†³" aria-label="Permalink to &quot;è§£å†³&quot;">â€‹</a></h2><h3 id="å…³é—­-swap" tabindex="-1">å…³é—­ swap <a class="header-anchor" href="#å…³é—­-swap" aria-label="Permalink to &quot;å…³é—­ swap&quot;">â€‹</a></h3><p>åœ¨é‡‡ç”¨è¿™æ ·çš„æ–¹æ³•è§£å†³é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—å…ˆçŸ¥é“ä»€ä¹ˆæ˜¯ swap ä»¥åŠå…³æ‰ä¹‹åçš„å‰¯ä½œç”¨ä»¥é¿å…é¢å¤–çš„é—®é¢˜å¯¼è‡´æ‚²å‰§çš„å‘ç”Ÿï¼š</p><blockquote><p>swap æ˜¯ç£ç›˜ä¸Šçš„ä¸€å—åŒºåŸŸï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªåˆ†åŒºï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ä»–ä»¬çš„ç»„åˆã€‚ç®€å•ç‚¹è¯´ï¼Œå½“ç³»ç»Ÿç‰©ç†å†…å­˜åƒç´§æ—¶ï¼ŒLinuxä¼šå°†å†…å­˜ä¸­ä¸å¸¸è®¿é—®çš„æ•°æ®ä¿å­˜åˆ°swapä¸Šï¼Œè¿™æ ·ç³»ç»Ÿå°±æœ‰æ›´å¤šçš„ç‰©ç†å†…å­˜ä¸ºå„ä¸ªè¿›ç¨‹æœåŠ¡ï¼Œè€Œå½“ç³»ç»Ÿéœ€è¦è®¿é—®swapä¸Šå­˜å‚¨çš„å†…å®¹æ—¶ï¼Œå†å°†swapä¸Šçš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p></blockquote><p>æ‰€ä»¥å¦‚æœä½ åœ¨ <strong>å†…å­˜ä¸å¤Ÿç”¨</strong>ã€<strong>å†…å­˜å‹‰å¼ºå¤Ÿç”¨</strong> çš„æƒ…å†µä¸‹ï¼Œè¯·å‹¿å…³é—­ swapï¼Œè¿™å¯èƒ½å¯¼è‡´å‡ºç° out of memoryï¼ˆå†…å­˜è€—å°½ï¼‰çš„é”™è¯¯ä»è€Œå¯¼è‡´æ›´éš¾ä»ç¾éš¾ä¸­æ¢å¤æœåŠ¡ç”šè‡³æ˜¯æ¢å¤ç³»ç»Ÿã€‚åä¹‹ï¼Œå¦‚æœä½ åœ¨ <strong>å†…å­˜å……è£•</strong> çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥è€ƒè™‘å…³é—­ swap çš„ï¼Œä½†ä¾ç„¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå†…å­˜ç”¨é‡åƒç´§è€Œæ­¤æ—¶æ­¤åˆ»åˆæ²¡æœ‰é…ç½® swap çš„è¯ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿç³»ç»Ÿå†…æ ¸çš„ OOM Killer ä¼šè¢«è§¦å‘ï¼Œå¹¶å°†è€—å†…å­˜çš„è¿›ç¨‹ä¼˜å…ˆç»ˆæ­¢æ‰ï¼Œæ­¤æ—¶å¯èƒ½æ˜¯ç»ˆæ­¢çš„éƒ¨åˆ†çš„å®¹å™¨å†…è¿›ç¨‹ï¼Œä¹Ÿè®¸ä¼šå½±å“åˆ°æœåŠ¡çš„è¿ä½œï¼Œå¦‚æœè¿˜æœ‰éƒ¨åˆ†çš„ k8s æˆ–è€…æ˜¯ systemd å®ˆæŠ¤è¿›ç¨‹å­˜æ´»ï¼Œé‚£å¯èƒ½å…¶ä¼šå†æ¬¡å°†åŸå…ˆè¢«æ€æ‰çš„è¿›ç¨‹æ‹‰æ´»ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šæœ‰ä¸€ä¸ªç­‰å¾…æ—¶é—´ï¼›å¦‚æœé…ç½®äº† swapï¼Œé‚£å†…å­˜å‹åŠ›ä¼šæ‰©æ•£åˆ° swap åŒºåŸŸçš„å‹åŠ›ä¸Šï¼Œå¹¶ä½¿æœåŠ¡å™¨è‹Ÿå»¶æ®‹å–˜ä¸€ä¼šå„¿ï¼Œé€šå¸¸ä¼šå‘ç”ŸæœåŠ¡é™çº§ï¼Œè¿™ä¸ªæ—¶å€™ä¹Ÿä¼šéœ€è¦è¿ç»´äººå‘˜å°½å¿«æ‰©å®¹å¹¶æ’æŸ¥å†…å­˜æ¶ˆè€—çš„é—®é¢˜ã€‚</p><h4 id="å¦‚æœæ²¡æœ‰-swap-åˆ†åŒº" tabindex="-1">å¦‚æœæ²¡æœ‰ swap åˆ†åŒº <a class="header-anchor" href="#å¦‚æœæ²¡æœ‰-swap-åˆ†åŒº" aria-label="Permalink to &quot;å¦‚æœæ²¡æœ‰ swap åˆ†åŒº&quot;">â€‹</a></h4><div class="warning custom-block"><p class="custom-block-title">æ³¨æ„</p><p>ä¸‹é¢æ­¥éª¤ä¸­ä½¿ç”¨çš„ <code>swapoff -a</code> çš„å‘½ä»¤å¹¶ä¸æ˜¯å®Œå…¨æœ‰æ•ˆçš„ï¼Œåœ¨ç³»ç»Ÿä¸­æœ‰é…ç½® <code>systemd</code> ï¼Œä¸”ç³»ç»Ÿç›˜ä¸­æœ‰ swap åˆ†åŒºçš„æƒ…å†µä¸‹ï¼ˆé€šè¿‡æ‰§è¡Œ <code>sudo fdisk -l</code> æˆ–è€…åœ¨ <code>/etc/fstab</code> ä¸­å¯ä»¥æŸ¥è¯¢ï¼‰ï¼Œ<code>systemd</code> åœ¨å¯åŠ¨åæ‰«æåˆ° swap åˆ†åŒºæ—¶å°±ä¼šè‡ªåŠ¨æŒ‚è½½ swap åˆ†åŒºï¼Œå¹¶ä¸”å°†ä¸€ä¸ªåä¸º <code>dev-&lt;dev åç§°&gt;.swap</code> çš„ <code>systemd</code> å•å…ƒåŠ è½½å¹¶æ¿€æ´»ï¼Œè¿™ä¼šå¯¼è‡´ swap é‡æ–°è¢«å¼€å¯ï¼Œè¿™å¯¼è‡´ <code>swapoff -a</code> å‘½ä»¤çš„ç»“æœåªä¼šåœ¨æœ¬æ¬¡å·²ç»å¯åŠ¨çš„ç³»ç»Ÿä¸­ç”Ÿæ•ˆï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœéœ€è¦æ°¸ä¹…æ€§å…³é—­ swapï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œé¢å¤–çš„æ“ä½œã€‚</p></div><p>è¦äº†è§£å½“å‰çš„ swap ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swapon</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -s</span></span></code></pre></div><p>åœ¨äº†è§£å®Œä¸Šè¿°æƒ…å†µä¹‹åå¦‚æœä»éœ€è¦ä¸´æ—¶å…³é—­ swapï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swapoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><p>å¦‚æœéœ€è¦æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swapon</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤é‡å¯ <code>kubelet</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubelet</span></span></code></pre></div><p>ç„¶åæˆ‘ä»¬åœ¨é›†ç¾¤å†…å…¶ä»–èŠ‚ç‚¹ä¸­å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nodes</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™å°±èƒ½çœ‹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„çŠ¶æ€å˜æ›´ä¸º <code>Ready</code> äº†ã€‚</p><h4 id="å¦‚æœæœ‰-swap-åˆ†åŒº" tabindex="-1">å¦‚æœæœ‰ swap åˆ†åŒº <a class="header-anchor" href="#å¦‚æœæœ‰-swap-åˆ†åŒº" aria-label="Permalink to &quot;å¦‚æœæœ‰ swap åˆ†åŒº&quot;">â€‹</a></h4><p>åœ¨ç°ä»£çš„ç»å¤§å¤šæ•° Linux ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿå®‰è£…æ—¶çš„è‡ªåŠ¨åˆ†åŒºå¯èƒ½å·²ç»å¸®ä½ åˆ†åŒºå¥½äº† swap åˆ†åŒºï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦åšä¸€äº›é¢å¤–çš„æ“ä½œã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æœ‰ swap åˆ†åŒºå’Œ swap åˆ†åŒºæ˜¯å¦è¢« <code>systemd</code> æ§åˆ¶ï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤äº†è§£åˆ°ï¼š</p><p>é€šè¿‡ <code>fdisk</code> æŸ¥è¯¢ç¡¬ç›˜çš„åˆ†åŒºï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fdisk</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 40</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GiB,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 42949672960</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sectors</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> model:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Virtual</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Disk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Units:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (logical/physical): 512 bytes / 4096 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">I/O</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (minimum/optimal): 4096 bytes / 4096 bytes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disklabel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gpt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> identifier:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 438E101B-2565-4003-948F-454B7A695D32</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Device</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        Start</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      End</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Sectors</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Type</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/sda1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1050623</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1048576</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  512M</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> EFI</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> System</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/sda2</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   1050624</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 81885183</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80834560</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 38.5G</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">/dev/sda3</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  81885184</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 83884031</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1998848</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  976M</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swap</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ° <code>/dev/sda3</code> åœ¨è®¾å¤‡ä¸Šæœ‰ä¸€ä¸ª Linux swap åˆ†åŒºã€‚</p><p>æŸ¥çœ‹ <code>/etc/fstab</code>ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span>$ sudo cat /etc/fstab | grep swap</span></span>
<span class="line"><span># swap was on /dev/sda3 during installation</span></span>
<span class="line"><span>UUID=ec583562-8777-45cb-9512-e19b7ae96ee3 none            swap    sw              0       0</span></span></code></pre></div><p>ä¸ºäº†æ–¹ä¾¿äº†è§£ UUID å¯¹åº”çš„è®¾å¤‡æ˜¯å“ªä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>ls -la</code> å‘½ä»¤æŸ¥çœ‹ <code>/dev/disk/by-uuid</code> ç›®å½•ä¸‹çš„æ˜ å°„ï¼Œå¯ä»¥å‘ç° <code>ec583562-8777-45cb-9512-e19b7ae96ee3</code> æ˜¯ <code>/dev/sda3</code> çš„è½¯é“¾æ¥ï¼Œä¸ <code>fdisk -l</code> è·å¾—çš„ä¿¡æ¯ä¸€è‡´ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -la</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /dev/disk/by-uuid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">æ€»ç”¨é‡</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  3æœˆ</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 120</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  3æœˆ</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ..</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lrwxrwxrwx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  3æœˆ</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 325D-4C1F</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../sda1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lrwxrwxrwx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  3æœˆ</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c10110c9-c86b-4020-ad6c-78e46ec3e642</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../sda2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lrwxrwxrwx</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  10</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  3æœˆ</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  8</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ec583562-8777-45cb-9512-e19b7ae96ee3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ../../sda3</span></span></code></pre></div><p>é€šè¿‡ <code>systemctl --all --type swap</code> ç­›é€‰å‡ºæ‰€æœ‰ç±»å‹ä¸º <code>swap</code> çš„ <code>systemd</code> å•å…ƒï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --all</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --type</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swap</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  UNIT</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          LOAD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   ACTIVE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   SUB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  DESCRIPTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">â—</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dev-sda3.swap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loaded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> active</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mounted</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dev-sda3.swap</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LOAD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Reflects</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> whether</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> definition</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> properly</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loaded.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ACTIVE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> The</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> high-level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> activation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> state,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> i.e.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> generalization</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> SUB.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SUB</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> The</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> low-level</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> activation</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> state,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> values</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> depend</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> type.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loaded</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> units</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> listed.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">To</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> installed</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unit</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;systemctl list-unit-files&#39;.</span></span></code></pre></div><p>æˆ‘ä»¬å‘ç°å‘½ä»¤è¿”å›äº†ä¸€ä¸ªåä¸º <code>dev-sda3.swap</code> çš„ <code>systemd</code> å•å…ƒï¼Œåç§°ä¸æˆ‘ä»¬ä¹‹å‰é€šè¿‡ <code>fdisk</code> å’ŒæŸ¥è¯¢ <code>/etc/fstab</code> è·å¾—çš„ä¸€è‡´ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦ä¸€æ­¥ä¸€æ­¥æ“ä½œï¼Œå°† swap å®Œå…¨ç¦ç”¨ã€‚</p><p>å…ˆæ‰§è¡Œä¸€ä¸‹ <code>swapoff -a</code> ä½¿æœ¬æ¬¡å¯åŠ¨çš„ç³»ç»Ÿåœæ­¢ swapï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> swapoff</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œéœ€è¦ç¼–è¾‘ <code>/etc/fstab</code> å°†ç³»ç»Ÿå¯åŠ¨åè‡ªåŠ¨æŒ‚è½½ swap åˆ†åŒºçš„æŒ‡ä»¤æ³¨é‡Šèµ·æ¥æˆ–è€…æ•´è¡Œåˆ é™¤æ‰ï¼Œå¦‚æœæŒ‡ä»¤è¿‡å¤šï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ <code>/etc/fstab</code> æŸ¥æ‰¾ swap ç›¸å…³çš„å…³é”®å­—å¹¶ä¸”æŠŠæŒ‡ä»¤åˆ é™¤ã€‚ æœ€ç»ˆè¾¾åˆ°ç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ç»“æœï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span># swap was on /dev/sda3 during installation</span></span>
<span class="line"><span># UUID=ec583562-8777-45cb-9512-e19b7ae96ee3 none            swap    sw              0       0</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¸Šé¢é€šè¿‡ <code>systemctl --all --type swap</code> è·å¾—çš„å•å…ƒ mask æ‰ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mask</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dev-sd3.swap</span></span></code></pre></div><p>æœ€åæˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤é‡å¯ <code>kubelet</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubelet</span></span></code></pre></div><p>ç„¶åæˆ‘ä»¬åœ¨é›†ç¾¤å†…å…¶ä»–èŠ‚ç‚¹ä¸­å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nodes</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™å°±èƒ½çœ‹åˆ°ç›®æ ‡èŠ‚ç‚¹çš„çŠ¶æ€å˜æ›´ä¸º <code>Ready</code> äº†ã€‚</p><h3 id="é…ç½®-k8s-ç›¸å…³ç»„ä»¶ä»¥æ”¯æŒä¸æŠ¥é”™" tabindex="-1">é…ç½® k8s ç›¸å…³ç»„ä»¶ä»¥æ”¯æŒä¸æŠ¥é”™ <a class="header-anchor" href="#é…ç½®-k8s-ç›¸å…³ç»„ä»¶ä»¥æ”¯æŒä¸æŠ¥é”™" aria-label="Permalink to &quot;é…ç½® k8s ç›¸å…³ç»„ä»¶ä»¥æ”¯æŒä¸æŠ¥é”™&quot;">â€‹</a></h3><p>åœ¨é‡‡ç”¨è¿™æ ·çš„æ–¹æ¡ˆä¹‹å‰æˆ‘å»ºè®®å¯¹ç›¸å…³çš„æ–‡æ¡£è¿›è¡Œé˜…è¯»ä»¥äº†è§£ kubernetes ä¸ºä½•ä¸æ”¯æŒåœ¨ swap å¼€å¯çš„æ—¶å€™è¿è¡Œï¼š</p>`,57),A=l(`<p>ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æ¥æŸ¥çœ‹ kubelet çš„ systemd é…ç½®ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubelet</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥åœ¨æ‰“å°å‡ºæ¥çš„è¡Œä¸­æ‰¾åˆ°è¿™æ ·ä¸€æ¡ï¼š</p><blockquote><p><code># /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code></p></blockquote><p>è¿™ä»£è¡¨ kubelet systemd æ˜¯å¤šæ–‡ä»¶ç»„æˆçš„ï¼Œæˆ‘ä»¬éœ€è¦ç›´æ¥ç¼–è¾‘ <code>/etc/systemd/system/kubelet.service.d</code> å¹¶æ·»åŠ é¢å¤–å‚æ•°æ‰èƒ½è§£å†³é—®é¢˜ï¼š</p><p>æºæ–‡ä»¶ï¼š</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Note: This dropin only works with kubeadm and kubelet v1.11+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># This is a file that &quot;kubeadm init&quot; and &quot;kubeadm join&quot; generate at runtime, populating the KUBELET_KUBEADM_ARGS variable dynamically</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">EnvironmentFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">-/var/lib/kubelet/kubeadm-flags.env</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># This is a file that the user can use for overrides of the kubelet args as a last resort. Preferably, the user should use</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># the .NodeRegistration.KubeletExtraArgs object in the configuration files instead. KUBELET_EXTRA_ARGS should be sourced from this file.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">EnvironmentFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">-/etc/default/kubelet</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_EXTRA_ARGS=--node-ip=10.24.0.2 --hostname-override=node01 &quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">/usr/local/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS</span></span></code></pre></div><p>æˆ‘ä»¬åœ¨è¡Œ</p><blockquote><p>Environment=&quot;KUBELET_EXTRA_ARGS=--node-ip=10.24.0.2 --hostname-override=node01 &quot;</p></blockquote><p>å°¾éƒ¨æ·»åŠ  <code>--fail-swap-on=false</code> æ¥è¿›è¡Œé…ç½®</p><p>å˜æ›´åçš„æ–‡ä»¶ï¼š</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Note: This dropin only works with kubeadm and kubelet v1.11+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># This is a file that &quot;kubeadm init&quot; and &quot;kubeadm join&quot; generate at runtime, populating the KUBELET_KUBEADM_ARGS variable dynamically</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">EnvironmentFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">-/var/lib/kubelet/kubeadm-flags.env</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># This is a file that the user can use for overrides of the kubelet args as a last resort. Preferably, the user should use</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># the .NodeRegistration.KubeletExtraArgs object in the configuration files instead. KUBELET_EXTRA_ARGS should be sourced from this file.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">EnvironmentFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">-/etc/default/kubelet</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;KUBELET_EXTRA_ARGS=--node-ip=10.24.0.2 --hostname-override=node01 --fail-swap-on=false&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#98C379;">/usr/local/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS</span></span></code></pre></div><h4 id="é¢å¤–è¯´æ˜" tabindex="-1">é¢å¤–è¯´æ˜ <a class="header-anchor" href="#é¢å¤–è¯´æ˜" aria-label="Permalink to &quot;é¢å¤–è¯´æ˜&quot;">â€‹</a></h4><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åˆ›å»º k8s æ§åˆ¶å¹³é¢çš„æ—¶å€™æ‰€æ‰§è¡Œçš„ <code>kubeadm init</code> å‘½ä»¤åæ·»åŠ  <code>--ignore-preflight-errors=Swap</code> å‚æ•°æ¥ä¸ºé›†ç¾¤ä¸­æ¯ä¸€ä¸ª kubelet è¿›è¡Œé…ç½®ã€‚</p><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1">å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2>`,15);function m(f,E,w,_,D,B){const p=t("NolebasePageProperties"),e=t("VPNolebaseInlineLinkPreview"),h=t("NolebaseGitContributors"),k=t("NolebaseGitChangelog");return r(),o("div",null,[g,i(p),u,s("table",y,[C,s("tbody",null,[s("tr",null,[F,b,s("td",null,[i(e,{href:"https://v1-22.docs.kubernetes.io/",target:"_blank",rel:"noreferrer"},{default:n(()=>[a("https://v1-22.docs.kubernetes.io/")]),_:1})])])])]),v,s("p",null,[i(e,{href:"https://github.com/kubernetes/kubeadm/issues/610",target:"_blank",rel:"noreferrer"},{default:n(()=>[a("ERROR Swap: running with swap on is not supported. Please disable swap Â· Issue #610 Â· kubernetes/kubeadm")]),_:1}),i(e,{href:"https://kubernetes.io/blog/2021/08/04/kubernetes-1-22-release-announcement/#node-system-swap-support",target:"_blank",rel:"noreferrer"},{default:n(()=>[a("Kubernetes 1.22: Reaching New Peaks | Kubernetes")]),_:1})]),A,s("p",null,[i(e,{href:"https://askubuntu.com/questions/440326/how-can-i-turn-off-swap-permanently/1292453#1292453",target:"_blank",rel:"noreferrer"},{default:n(()=>[a("How can I turn off swap permanently? - Ask Ubuntu")]),_:1})]),s("p",null,[i(e,{href:"https://askubuntu.com/questions/440326/how-can-i-turn-off-swap-permanently/984777#984777",target:"_blank",rel:"noreferrer"},{default:n(()=>[a("How can I turn off swap permanently? - Ask Ubuntu")]),_:1})]),i(h),i(k)])}const T=d(c,[["render",m]]);export{x as __pageData,T as default};
