import{_ as p,c as k,I as s,j as e,a,w as d,au as o,D as i,o as r}from"./chunks/framework.RMxno62p.js";const E=JSON.parse('{"title":"通过 apt 升级和更新 1.28.4 版本的 kubeadm","description":"","frontmatter":{"tags":["计算机/操作系统/Linux","操作系统/Debian","操作系统/Debian/Debian-11","操作系统/Unix","运维/云原生/Kubernetes/K8s","运维/云原生/Kubernetes","命令行/kubectl","软件/云原生/kubectl","命令行/kubeadm","软件/云原生/kubeadm","软件/云原生/kubelet","命令行/apt","计算机/网络/Cilium","运维/Cilium","命令行/cilium","软件/云原生/Cilium"]},"headers":[],"relativePath":"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md","filePath":"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md"}'),c={name:"笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/通过 apt 升级和更新 1.28.4 版本的 kubeadm.md"},g=e("h1",{id:"通过-apt-升级和更新-1-28-4-版本的-kubeadm",tabindex:"-1"},[a("通过 apt 升级和更新 1.28.4 版本的 kubeadm "),e("a",{class:"header-anchor",href:"#通过-apt-升级和更新-1-28-4-版本的-kubeadm","aria-label":'Permalink to "通过 apt 升级和更新 1.28.4 版本的 kubeadm"'},"​")],-1),F=o(`<h2 id="解除-debian-apt-依赖锚定-hold" tabindex="-1">解除 Debian <code>apt</code> 依赖锚定（hold） <a class="header-anchor" href="#解除-debian-apt-依赖锚定-hold" aria-label="Permalink to &quot;解除 Debian \`apt\` 依赖锚定（hold）&quot;">​</a></h2><p>可以先看看 <code>apt-mark</code> 里面是否记录了 <code>kubeadm</code> 的锚定（hold）：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> showhold</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div><p>或者</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dpkg</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --get-selections</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;hold$&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div><p>如果返回值像是这样：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-highlighted vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> showhold</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubelet</span></span></code></pre></div><p>可以先解除锚定。通过下面的命令就可以解除锚定，我们一个一个来：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> unhold</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span></span></code></pre></div><h2 id="明确目标版本并升级" tabindex="-1">明确目标版本并升级 <a class="header-anchor" href="#明确目标版本并升级" aria-label="Permalink to &quot;明确目标版本并升级&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span></span></code></pre></div><p>就像这样</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro has-highlighted vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">正在排序...</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">全文搜索...</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm/未知</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1.28.4-1.1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> amd64</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [可从该版本升级：1.28.2-1.1] </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  Command-line</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> utility</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> administering</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Kubernetes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cluster</span></span></code></pre></div><p>接下来定向升级：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm=&#39;1.28.4-*&#39;</span></span></code></pre></div><p>升级完成之后确保 <code>kubeadm version</code> 的输出符合预期</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span></span></code></pre></div><p>比如</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubeadm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> version:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">version.Info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">{Major:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Minor:&quot;28&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GitVersion:&quot;v1.28.4&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GitCommit:&quot;bae2c62678db2b5053817bc97181fcc2e8388103&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GitTreeState:&quot;clean&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> BuildDate:&quot;2023-11-15T16:56:18Z&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GoVersion:&quot;go1.20.11&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Compiler:&quot;gc&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Platform:&quot;linux/amd64&quot;}</span></span></code></pre></div><h2 id="还原-debian-apt-依赖锚定-hold" tabindex="-1">还原 Debian <code>apt</code> 依赖锚定（hold） <a class="header-anchor" href="#还原-debian-apt-依赖锚定-hold" aria-label="Permalink to &quot;还原 Debian \`apt\` 依赖锚定（hold）&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> hold</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> kubeadm</span></span></code></pre></div><p>锚定之后检查一下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apt-mark</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> showhold</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> more</span></span></code></pre></div>`,23);function u(C,b,y,m,v,_){const t=i("NolebasePageProperties"),l=i("VPNolebaseInlineLinkPreview"),n=i("NolebaseGitContributors"),h=i("NolebaseGitChangelog");return r(),k("div",null,[g,s(t),F,e("p",null,[a("接下来返回 "),s(l,{href:"/笔记/🧱 基础设施/🚢 Kubernetes/Kubernetes 集群的日常升级和更新/1.28.2 升级和更新的操作步骤.html"},{default:d(()=>[a("1.28.2 升级和更新的操作步骤")]),_:1}),a("继续操作吧。")]),s(n),s(h)])}const B=p(c,[["render",u]]);export{E as __pageData,B as default};
